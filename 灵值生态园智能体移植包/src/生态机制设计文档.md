# 媄月商业艺术 - 生态机制设计文档

## 📋 概述

本生态机制将新型合伙制与项目制深度融合，实现：
1. **多层级收益**：项目利润 + 推荐佣金 + 分红股权
2. **成长激励**：从普通会员到专家的升级路径
3. **生态闭环**：佣金注入分红池，实现价值循环

---

## 🎯 核心机制

### 1. 会员级别体系

| 级别 | 级别代码 | 达标条件 | 分红权 | 分红比例 |
|------|---------|---------|--------|---------|
| 普通会员 | 1 | 初始加入 | ❌ | 0% |
| 专家 | 2 | 贡献值达标 | ✅ | 0.1% |

### 2. 收益来源

#### 项目利润
- 直接参与项目获得的利润分成
- 根据项目类型和个人贡献度分配

#### 推荐佣金
- **来源**：分享项目创业机会，对方购买机会后的资金
- **计算方式**：项目机会价值 × 佣金率
- **分配**：
  - 推荐人：90%（直接获得）
  - 分红池：5%（进入分红池）
  - 平台：5%（平台运营）

#### 分红股权
- **获得条件**：达到专家级别
- **分红比例**：公司分红股权的0.1%
- **分红来源**：分红池（推荐佣金的5%累积）

### 3. 分红池机制

```
推荐佣金产生 → 5%注入分红池 → 专家按比例分红
```

- **分红池规模** = 所有推荐佣金的5%总和
- **分红周期**：按月/按季度分红
- **分红方式**：按专家持有比例分配

### 4. 前期投资

- 公司在项目启动前投入资金
- 投资类型：
  - 项目开发成本
  - 市场推广费用
  - 运营成本
- 投资回报：
  - 项目利润优先回收投资
  - 超额部分进入分红池

---

## 📊 数据模型设计

### 表1：MemberLevel（会员级别表）

```sql
CREATE TABLE member_levels (
    id INTEGER PRIMARY KEY,
    level_name VARCHAR(50) NOT NULL,      -- 级别名称（普通会员、专家）
    level_code INTEGER NOT NULL UNIQUE,   -- 级别代码（1=普通, 2=专家）
    required_contribution DECIMAL(10,2) DEFAULT 0,  -- 达到该级别需要的贡献值
    has_dividend_right BOOLEAN DEFAULT FALSE,       -- 是否有分红权
    dividend_percentage DECIMAL(5,4) DEFAULT 0,     -- 分红比例（0.001 = 0.1%）
    benefits TEXT,                                  -- 级别权益描述
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 表2：Member（会员表）

```sql
CREATE TABLE members (
    id INTEGER PRIMARY KEY,
    user_id INTEGER NOT NULL,                    -- 用户ID（关联users表）
    level_id INTEGER DEFAULT 1,                  -- 当前级别ID（默认普通会员）
    total_contribution DECIMAL(10,2) DEFAULT 0,  -- 总贡献值
    total_commission DECIMAL(10,2) DEFAULT 0,    -- 总佣金
    total_profit DECIMAL(10,2) DEFAULT 0,        -- 总项目利润
    referral_code VARCHAR(20) UNIQUE NOT NULL,   -- 推荐码
    referrer_id INTEGER,                         -- 推荐人ID
    referrer_path TEXT,                          -- 推荐路径（1-5-3）
    joined_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,   -- 加入时间
    upgraded_to_expert_at TIMESTAMP,             -- 升级到专家的时间
    last_dividend_at TIMESTAMP,                  -- 上次分红时间
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (level_id) REFERENCES member_levels(id),
    FOREIGN KEY (referrer_id) REFERENCES members(id)
);
```

### 表3：Project（项目表）

```sql
CREATE TABLE projects (
    id INTEGER PRIMARY KEY,
    project_name VARCHAR(100) NOT NULL,          -- 项目名称
    project_type VARCHAR(50) NOT NULL,           -- 项目类型
    description TEXT,                            -- 项目描述
    project_value DECIMAL(10,2) NOT NULL,        -- 项目价值（购买机会的资金）
    profit_margin DECIMAL(5,2) DEFAULT 0,        -- 利润率（百分比）
    commission_rate DECIMAL(5,2) DEFAULT 0,      -- 佣金率（百分比）
    status VARCHAR(20) DEFAULT 'planning',       -- 状态（planning, running, completed, cancelled）
    company_investment DECIMAL(10,2) DEFAULT 0,  -- 公司前期投资
    actual_cost DECIMAL(10,2) DEFAULT 0,         -- 实际成本
    start_date DATE,                             -- 开始日期
    end_date DATE,                               -- 结束日期
    total_profit DECIMAL(10,2) DEFAULT 0,        -- 总利润
    created_by INTEGER,                          -- 创建人ID
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 表4：ProjectParticipation（项目参与表）

```sql
CREATE TABLE project_participations (
    id INTEGER PRIMARY KEY,
    project_id INTEGER NOT NULL,                 -- 项目ID
    member_id INTEGER NOT NULL,                  -- 会员ID
    role VARCHAR(50),                            -- 角色（participant, operator, manager）
    contribution_amount DECIMAL(10,2) DEFAULT 0,  -- 贡献金额
    contribution_points DECIMAL(10,2) DEFAULT 0, -- 贡献点数
    profit_share DECIMAL(5,2) DEFAULT 0,         -- 利润分成比例
    profit_amount DECIMAL(10,2) DEFAULT 0,       -- 实际利润金额
    joined_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (project_id) REFERENCES projects(id),
    FOREIGN KEY (member_id) REFERENCES members(id)
);
```

### 表5：ReferralCommission（推荐佣金表）

```sql
CREATE TABLE referral_commissions (
    id INTEGER PRIMARY KEY,
    referrer_id INTEGER NOT NULL,                -- 推荐人ID
    referee_id INTEGER NOT NULL,                 -- 被推荐人ID
    project_id INTEGER NOT NULL,                 -- 项目ID
    opportunity_value DECIMAL(10,2) NOT NULL,    -- 机会价值（购买机会的资金）
    commission_rate DECIMAL(5,2) NOT NULL,       -- 佣金率
    total_commission DECIMAL(10,2) NOT NULL,     -- 总佣金
    referrer_share DECIMAL(10,2) NOT NULL,       -- 推荐人份额（90%）
    dividend_pool_share DECIMAL(10,2) NOT NULL,  -- 分红池份额（5%）
    platform_share DECIMAL(10,2) NOT NULL,       -- 平台份额（5%）
    commission_status VARCHAR(20) DEFAULT 'pending', -- 状态（pending, paid, cancelled）
    paid_at TIMESTAMP,                           -- 支付时间
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (referrer_id) REFERENCES members(id),
    FOREIGN KEY (referee_id) REFERENCES members(id),
    FOREIGN KEY (project_id) REFERENCES projects(id)
);
```

### 表6：DividendPool（分红池表）

```sql
CREATE TABLE dividend_pools (
    id INTEGER PRIMARY KEY,
    pool_name VARCHAR(50) NOT NULL,              -- 分红池名称
    total_amount DECIMAL(10,2) DEFAULT 0,        -- 总金额
    accumulated_commission DECIMAL(10,2) DEFAULT 0,  -- 累积佣金
    total_distributed DECIMAL(10,2) DEFAULT 0,   -- 已分配金额
    status VARCHAR(20) DEFAULT 'active',         -- 状态（active, paused, closed）
    last_dividend_date DATE,                     -- 上次分红日期
    next_dividend_date DATE,                     -- 下次分红日期
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 表7：DividendRecord（分红记录表）

```sql
CREATE TABLE dividend_records (
    id INTEGER PRIMARY KEY,
    dividend_pool_id INTEGER NOT NULL,           -- 分红池ID
    member_id INTEGER NOT NULL,                  -- 会员ID
    dividend_period VARCHAR(20) NOT NULL,        -- 分红周期（2026-01）
    dividend_amount DECIMAL(10,2) NOT NULL,      -- 分红金额
    dividend_percentage DECIMAL(5,4),            -- 分红比例
    status VARCHAR(20) DEFAULT 'pending',        -- 状态（pending, paid）
    paid_at TIMESTAMP,                           -- 支付时间
    notes TEXT,                                  -- 备注
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (dividend_pool_id) REFERENCES dividend_pools(id),
    FOREIGN KEY (member_id) REFERENCES members(id)
);
```

### 表8：EarlyInvestment（前期投资表）

```sql
CREATE TABLE early_investments (
    id INTEGER PRIMARY KEY,
    project_id INTEGER NOT NULL,                 -- 项目ID
    investment_type VARCHAR(50) NOT NULL,        -- 投资类型（development, marketing, operations）
    amount DECIMAL(10,2) NOT NULL,               -- 投资金额
    description TEXT,                            -- 描述
    investor VARCHAR(50) DEFAULT 'company',      -- 投资方（company, external）
    investment_date DATE NOT NULL,               -- 投资日期
    expected_return_rate DECIMAL(5,2),           -- 预期回报率
    actual_return DECIMAL(10,2) DEFAULT 0,       -- 实际回报
    status VARCHAR(20) DEFAULT 'invested',       -- 状态（invested, returned, lost）
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (project_id) REFERENCES projects(id)
);
```

---

## 💰 收益计算逻辑

### 推荐佣金计算

```python
def calculate_commission(opportunity_value, commission_rate):
    """
    计算推荐佣金
    :param opportunity_value: 机会价值（购买机会的资金）
    :param commission_rate: 佣金率（百分比）
    :return: (总佣金, 推荐人份额, 分红池份额, 平台份额)
    """
    total_commission = opportunity_value * (commission_rate / 100)
    referrer_share = total_commission * 0.90  # 90%给推荐人
    dividend_pool_share = total_commission * 0.05  # 5%进入分红池
    platform_share = total_commission * 0.05  # 5%给平台
    
    return {
        'total_commission': total_commission,
        'referrer_share': referrer_share,
        'dividend_pool_share': dividend_pool_share,
        'platform_share': platform_share
    }
```

**示例**：
- 机会价值：10,000元
- 佣金率：10%
- 总佣金：10,000 × 10% = 1,000元
- 推荐人获得：1,000 × 90% = 900元
- 分红池获得：1,000 × 5% = 50元
- 平台获得：1,000 × 5% = 50元

### 分红计算

```python
def calculate_dividend(dividend_pool_amount, expert_member_count):
    """
    计算每位专家的分红
    :param dividend_pool_amount: 分红池总金额
    :param expert_member_count: 专家人数
    :return: 每位专家分红金额
    """
    dividend_per_expert = dividend_pool_amount * 0.001  # 0.1%分红比例
    # 如果有多位专家，需要进一步分配
    return dividend_per_expert
```

### 会员升级逻辑

```python
def check_upgrade(member):
    """
    检查会员是否可以升级
    :param member: 会员对象
    :return: 是否可以升级
    """
    if member.level.level_code == 1:  # 当前是普通会员
        expert_level = get_level_by_code(2)
        if member.total_contribution >= expert_level.required_contribution:
            return True
    return False
```

---

## 🔄 生态循环机制

### 流程图

```
1. 公司投资项目
   ↓
2. 项目上线，机会发布
   ↓
3. 会员分享项目机会
   ↓
4. 新人购买机会（资金进入）
   ↓
5. 佣金分配：
   - 90% 推荐人 → 现金收入
   - 5% 分红池 → 累积
   - 5% 平台 → 运营成本
   ↓
6. 项目产生利润
   ↓
7. 利润分配：
   - 优先回收投资
   - 参与者获得利润分成
   ↓
8. 会员累积贡献值
   ↓
9. 达标升级为专家
   ↓
10. 定期分红（分红池按0.1%分配给专家）
   ↓
11. 循环继续...
```

### 价值流动

```
前期投资 → 项目机会 → 购买资金 → 佣金分配
                                  ↓
                          分红池累积
                                  ↓
                          专家分红
                                  ↓
                          会员活跃度提升
                                  ↓
                          更多分享 → 更多购买
                                  ↓
                          更多佣金 → 更大分红池
```

---

## 📋 核心功能需求

### 1. 会员管理
- 注册会员，生成推荐码
- 查看会员级别和权益
- 贡献值累积
- 级别升级

### 2. 项目管理
- 创建项目（输入前期投资）
- 发布项目机会
- 项目参与管理
- 利润分配

### 3. 推荐系统
- 推荐人绑定
- 推荐佣金计算
- 推荐关系查询
- 推荐数据统计

### 4. 分红管理
- 分红池管理
- 分红计算
- 分红记录
- 分红发放

### 5. 投资管理
- 前期投资记录
- 投资回报追踪
- 投资回收

### 6. 数据统计
- 会员增长统计
- 项目收益统计
- 佣金统计
- 分红统计

---

## ⚠️ 风险提示

### 1. 法律风险
- 严禁"拉人头"模式，确保有实际商品或服务交易
- 推荐佣金必须基于真实项目机会购买
- 分红机制必须符合公司法规定

### 2. 财务风险
- 前期投资需要有明确的回报路径
- 分红池不能过度承诺
- 现金流管理

### 3. 运营风险
- 会员活跃度管理
- 项目质量控制
- 推荐关系纠纷处理

---

## 📝 后续开发计划

### 阶段一：核心功能（1-2周）
- 数据库模型创建
- 会员管理API
- 推荐佣金计算
- 基础报表

### 阶段二：项目集成（2-3周）
- 项目管理API
- 项目参与管理
- 利润分配逻辑
- 前期投资管理

### 阶段三：分红系统（1-2周）
- 分红池管理
- 分红计算和发放
- 分红记录查询

### 阶段四：智能体集成（1周）
- 生态机制Prompt
- 智能体工具集成
- 用户交互优化

---

**媄月商业艺术 - 文化科技驱动的品牌未来资产**
**© 2026 媄月商业 版权所有 | 未经授权不得复制、下载、传播**
