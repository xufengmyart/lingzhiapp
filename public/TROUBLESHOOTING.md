# ðŸš¨ é—®é¢˜è¯Šæ–­æŒ‡å—

## ðŸ“ é—®é¢˜çŠ¶æ€
æ‚¨åé¦ˆ"é—®é¢˜ä¾ç„¶å­˜åœ¨"ï¼Œä½†éœ€è¦æ›´å¤šè¯¦ç»†ä¿¡æ¯æ¥å®šä½é—®é¢˜ã€‚è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œã€‚

---

## ðŸ” ç¬¬ä¸€æ­¥ï¼šè®¿é—®è¯Šæ–­é¡µé¢

**è¯·åœ¨æµè§ˆå™¨ä¸­è®¿é—®ä»¥ä¸‹URLï¼š**

```
http://ä½ çš„å…¬ç½‘IP/diagnose.html
```

ä¾‹å¦‚ï¼š`http://123.45.67.89/diagnose.html`

---

## ðŸ“Š ç¬¬äºŒæ­¥ï¼šè¿è¡Œå®Œæ•´æµ‹è¯•

1. æ‰“å¼€è¯Šæ–­é¡µé¢åŽï¼Œç‚¹å‡» **"ðŸš€ è¿è¡Œå®Œæ•´æµ‹è¯•"** æŒ‰é’®
2. ç­‰å¾…æ‰€æœ‰æµ‹è¯•å®Œæˆï¼ˆçº¦5-10ç§’ï¼‰
3. æŸ¥çœ‹æµ‹è¯•ç»“æžœ

---

## ðŸ“¸ ç¬¬ä¸‰æ­¥ï¼šæˆªå›¾å¹¶åé¦ˆ

è¯·æˆªå›¾ä»¥ä¸‹ä¿¡æ¯åé¦ˆç»™æˆ‘ï¼š

### å¿…é¡»æä¾›çš„æˆªå›¾ï¼š
1. **æ­¥éª¤1ï¼šæ£€æŸ¥å½“å‰è®¿é—®åœ°å€** - æ˜¾ç¤ºå½“å‰URL
2. **æ­¥éª¤3ï¼šè‡ªåŠ¨æ£€æµ‹APIåœ°å€** - æ˜¾ç¤ºæ£€æµ‹åˆ°çš„APIåœ°å€
3. **æ­¥éª¤5ï¼šæµ‹è¯•ç»“æžœ** - æ˜¾ç¤ºæ‰€æœ‰æµ‹è¯•ç»“æžœ

### éœ€è¦æŸ¥çœ‹çš„æŽ§åˆ¶å°ä¿¡æ¯ï¼ˆæŒ‰F12æ‰“å¼€ï¼‰ï¼š
1. åˆ‡æ¢åˆ° **"ç½‘ç»œ" (Network)** æ ‡ç­¾
2. åˆ·æ–°é¡µé¢
3. ç­›é€‰ **"XHR"** æˆ– **"Fetch"** è¯·æ±‚
4. æ‰¾åˆ°å¤±è´¥çš„è¯·æ±‚ï¼ŒæŸ¥çœ‹ï¼š
   - è¯·æ±‚URL
   - çŠ¶æ€ç 
   - å“åº”å†…å®¹

---

## ðŸŽ¯ å¯èƒ½çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### æƒ…å†µ1ï¼šAPIåœ°å€æ£€æµ‹é”™è¯¯
**ç—‡çŠ¶ï¼š**
- æ­¥éª¤3æ˜¾ç¤ºçš„APIåœ°å€ä¸æ˜¯ `http://ä½ çš„IP:8001`

**è§£å†³æ–¹æ³•ï¼š**
1. ç‚¹å‡»æ­¥éª¤4çš„ **"ðŸ—‘ï¸ æ¸…é™¤é…ç½®"** æŒ‰é’®
2. åˆ·æ–°é¡µé¢
3. å¦‚æžœä»ç„¶é”™è¯¯ï¼Œæ‰‹åŠ¨è¾“å…¥æ­£ç¡®çš„APIåœ°å€ï¼ˆä¾‹å¦‚ï¼š`http://123.45.67.89:8001`ï¼‰
4. ç‚¹å‡» **"ðŸ’¾ ä¿å­˜é…ç½®"** å¹¶åˆ·æ–°

---

### æƒ…å†µ2ï¼šAPIè¿žæŽ¥æµ‹è¯•å¤±è´¥
**ç—‡çŠ¶ï¼š**
- æ˜¾ç¤º "âœ— APIè¿žæŽ¥æµ‹è¯•å¤±è´¥"
- é”™è¯¯ä¿¡æ¯ï¼šé˜²ç«å¢™æ‹¦æˆªã€ç«¯å£æœªå¼€æ”¾ã€APIæœåŠ¡æœªå¯åŠ¨

**è§£å†³æ–¹æ³•ï¼š**

#### 1. æ£€æŸ¥é˜²ç«å¢™
```bash
sudo ufw status
```

ç¡®è®¤8001ç«¯å£æ˜¯å¦å¼€æ”¾ï¼š
```bash
sudo ufw allow 8001
sudo ufw reload
```

#### 2. æ£€æŸ¥åŽç«¯æœåŠ¡çŠ¶æ€
```bash
cd /workspace/projects
ps aux | grep python | grep 8001
```

å¦‚æžœæ²¡æœ‰è¿è¡Œï¼Œå¯åŠ¨åŽç«¯ï¼š
```bash
python src/main.py
```

#### 3. æµ‹è¯•æœ¬åœ°è¿žæŽ¥
```bash
curl http://127.0.0.1:8001/api/health
```

åº”è¯¥è¿”å›žï¼š
```json
{
  "status": "ok",
  "message": "Service is running"
}
```

#### 4. æµ‹è¯•å…¬ç½‘è¿žæŽ¥
```bash
# æ›¿æ¢ä¸ºä½ çš„å…¬ç½‘IP
curl http://ä½ çš„å…¬ç½‘IP:8001/api/health
```

å¦‚æžœå¤±è´¥ï¼Œå¯èƒ½æ˜¯é˜²ç«å¢™é—®é¢˜ã€‚

---

### æƒ…å†µ3ï¼šç™»å½•æµ‹è¯•å¤±è´¥
**ç—‡çŠ¶ï¼š**
- æ˜¾ç¤º "âœ— ç™»å½•æµ‹è¯•å¤±è´¥"
- çŠ¶æ€ç ï¼š500

**è§£å†³æ–¹æ³•ï¼š**

#### 1. æŸ¥çœ‹åŽç«¯æ—¥å¿—
```bash
tail -f /app/work/logs/bypass/app.log
```

#### 2. æ£€æŸ¥æ•°æ®åº“
```bash
cd /workspace/projects
python -c "
import sqlite3
conn = sqlite3.connect('lingzhi_ecosystem.db')
cursor = conn.cursor()
cursor.execute('SELECT username, email FROM users')
print(cursor.fetchall())
conn.close()
"
```

#### 3. éªŒè¯ç”¨æˆ·å­˜åœ¨
```bash
curl -X POST http://127.0.0.1:8001/api/login \
  -H "Content-Type: application/json" \
  -d '{"username":"testuser2_updated","password":"password123"}'
```

---

### æƒ…å†µ4ï¼šæµè§ˆå™¨ç¼“å­˜é—®é¢˜
**ç—‡çŠ¶ï¼š**
- æ˜Žæ˜Žä»£ç å·²ç»æ›´æ–°ï¼Œä½†è¡Œä¸ºæ²¡æœ‰æ”¹å˜

**è§£å†³æ–¹æ³•ï¼š**

1. **æ¸…é™¤æ‰€æœ‰ç¼“å­˜**
   - Windows/Linux: `Ctrl + Shift + Delete`
   - Mac: `Cmd + Shift + Delete`

2. **å‹¾é€‰å¹¶æ¸…é™¤ï¼š**
   - ç¼“å­˜çš„å›¾ç‰‡å’Œæ–‡ä»¶
   - Cookie å’Œå…¶ä»–ç½‘ç«™æ•°æ®

3. **å¼ºåˆ¶åˆ·æ–°**
   - Windows/Linux: `Ctrl + F5`
   - Mac: `Cmd + Shift + R`

4. **æ— ç—•æ¨¡å¼æµ‹è¯•**
   - æ‰“å¼€æ— ç—•/éšç§çª—å£
   - è®¿é—® `http://ä½ çš„å…¬ç½‘IP/diagnose.html`
   - æµ‹è¯•æ˜¯å¦èƒ½æ­£å¸¸å·¥ä½œ

---

## ðŸ’¡ æŽ¨èæ–¹æ¡ˆï¼šä½¿ç”¨Nginxåå‘ä»£ç†

å¦‚æžœä»¥ä¸Šæ–¹æ³•éƒ½æ— æ³•è§£å†³ï¼Œå»ºè®®é…ç½®Nginxåå‘ä»£ç†ï¼š

### ä¼˜åŠ¿ï¼š
- æ— éœ€æ‰‹åŠ¨é…ç½®APIåœ°å€
- è‡ªåŠ¨å¤„ç†è·¨åŸŸé—®é¢˜
- æ”¯æŒHTTPSï¼ˆåŽç»­å¯é…ç½®SSLè¯ä¹¦ï¼‰
- æ›´å¥½çš„æ€§èƒ½å’Œç¨³å®šæ€§

### å¿«é€Ÿé…ç½®ï¼š

```bash
# 1. å®‰è£…Nginx
sudo apt update
sudo apt install nginx -y

# 2. åˆ›å»ºé…ç½®æ–‡ä»¶
cat > /tmp/lingzhi-app.conf << 'EOF'
server {
    listen 80;
    server_name _;

    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /workspace/projects/public;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    # åå‘ä»£ç†åˆ°åŽç«¯API
    location /api/ {
        proxy_pass http://127.0.0.1:8001/api/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
EOF

# 3. åº”ç”¨é…ç½®
sudo cp /tmp/lingzhi-app.conf /etc/nginx/sites-available/lingzhi-app
sudo ln -sf /etc/nginx/sites-available/lingzhi-app /etc/nginx/sites-enabled/
sudo rm -f /etc/nginx/sites-enabled/default

# 4. æµ‹è¯•å¹¶é‡å¯
sudo nginx -t
sudo systemctl restart nginx

# 5. å¼€æ”¾é˜²ç«å¢™
sudo ufw allow 'Nginx Full'
```

é…ç½®å®ŒæˆåŽï¼Œè®¿é—® `http://ä½ çš„å…¬ç½‘IP/` å³å¯ä½¿ç”¨ã€‚

---

## ðŸ“ž å¦‚ä½•èŽ·å–å¸®åŠ©

å¦‚æžœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

### å¿…é¡»æä¾›ï¼š
1. âœ… è¯Šæ–­é¡µé¢çš„å®Œæ•´æˆªå›¾
2. âœ… æµè§ˆå™¨æŽ§åˆ¶å°çš„ç½‘ç»œè¯·æ±‚æˆªå›¾
3. âœ… åŽç«¯æ—¥å¿—ï¼ˆæœ€åŽ50è¡Œï¼‰

### å¯é€‰æä¾›ï¼š
1. æœåŠ¡å™¨æ“ä½œç³»ç»Ÿç‰ˆæœ¬
2. é˜²ç«å¢™çŠ¶æ€ï¼š`sudo ufw status`
3. åŽç«¯è¿›ç¨‹çŠ¶æ€ï¼š`ps aux | grep python | grep 8001`
4. æœ¬åœ°æµ‹è¯•ç»“æžœï¼š`curl http://127.0.0.1:8001/api/health`

---

## ðŸ”§ å¿«é€Ÿä¿®å¤å‘½ä»¤

ä¸€é”®æ‰§è¡Œå¸¸ç”¨æ£€æŸ¥ï¼š

```bash
cd /workspace/projects

# æ£€æŸ¥é˜²ç«å¢™
echo "=== é˜²ç«å¢™çŠ¶æ€ ==="
sudo ufw status

# æ£€æŸ¥åŽç«¯æœåŠ¡
echo -e "\n=== åŽç«¯æœåŠ¡çŠ¶æ€ ==="
ps aux | grep python | grep 8001

# æµ‹è¯•æœ¬åœ°API
echo -e "\n=== æœ¬åœ°APIæµ‹è¯• ==="
curl -s http://127.0.0.1:8001/api/health

# æ£€æŸ¥ç«¯å£ç›‘å¬
echo -e "\n=== ç«¯å£ç›‘å¬çŠ¶æ€ ==="
sudo netstat -tlnp | grep :8001

# æŸ¥çœ‹æœ€è¿‘æ—¥å¿—
echo -e "\n=== æœ€è¿‘20è¡Œæ—¥å¿— ==="
tail -n 20 /app/work/logs/bypass/app.log
```

---

## âœ… æˆåŠŸæ ‡å¿—

å½“ä»¥ä¸‹æ‰€æœ‰æ¡ä»¶æ»¡è¶³æ—¶ï¼Œé—®é¢˜å·²è§£å†³ï¼š

1. âœ… è¯Šæ–­é¡µé¢æ˜¾ç¤º "APIè¿žæŽ¥æµ‹è¯•æˆåŠŸ"
2. âœ… è¯Šæ–­é¡µé¢æ˜¾ç¤º "ç™»å½•æµ‹è¯•æˆåŠŸ"
3. âœ… åœ¨æ­£å¸¸é¡µé¢å¯ä»¥æˆåŠŸç™»å½•
4. âœ… ç™»å½•åŽå¯ä»¥æ­£å¸¸ä½¿ç”¨æ‰€æœ‰åŠŸèƒ½

---

**ä¸‹ä¸€æ­¥ï¼šè¯·è®¿é—® `http://ä½ çš„å…¬ç½‘IP/diagnose.html` å¹¶æä¾›æˆªå›¾ç»“æžœï¼**
