# çµå€¼ç”Ÿæ€å›­ v9.0 ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å®ŒæˆæŠ¥å‘Š

## ğŸ“Š æ‰§è¡Œæ‘˜è¦

**éƒ¨ç½²æ—¶é—´**: 2026-02-05
**éƒ¨ç½²æœåŠ¡å™¨**: 123.56.142.143
**åŸŸå**: https://meiyueart.com
**éƒ¨ç½²çŠ¶æ€**: âœ… æˆåŠŸ

---

## âœ… æ ¸å¿ƒé—®é¢˜ä¿®å¤

### é—®é¢˜1: åŸŸåè®¿é—®è¿”å›JSONè€ŒéHTML
**ç—‡çŠ¶**: è®¿é—® https://meiyueart.com è¿”å› `{"message":"çµå€¼ç”Ÿæ€å›­ API æœåŠ¡æ­£å¸¸è¿è¡Œ"...}` è€ŒéReactåº”ç”¨é¡µé¢

**æ ¹å› åˆ†æ**:
1. Nginxé…ç½®å°†æ ¹è·¯å¾„ `/` ä»£ç†åˆ°9000ç«¯å£ï¼Œä½†9000ç«¯å£æ— æœåŠ¡è¿è¡Œ
2. åº”è¯¥ç›´æ¥æä¾›é™æ€æ–‡ä»¶ `/var/www/lingzhiapp/public/index.html`

**è§£å†³æ–¹æ¡ˆ**:
```nginx
location / {
    root /var/www/lingzhiapp/public;
    try_files $uri $uri/ /index.html;
    index index.html;
}
```

### é—®é¢˜2: ç«¯å£å†²çªå¯¼è‡´æœåŠ¡ä¸ç¨³å®š
**ç—‡çŠ¶**: systemdæœåŠ¡ä¸æ–­é‡å¯ï¼ˆrestart counter è¾¾åˆ°114æ¬¡ï¼‰

**æ ¹å› åˆ†æ**:
1. æ‰‹åŠ¨å¯åŠ¨çš„Flaskè¿›ç¨‹ï¼ˆPID 66686ï¼‰å ç”¨äº†8080ç«¯å£
2. systemdæœåŠ¡å°è¯•å¯åŠ¨åŒä¸€ç«¯å£ï¼Œå¤±è´¥åä¸æ–­é‡å¯
3. ä¸¤ä¸ªè¿›ç¨‹ç«äº‰åŒä¸€ç«¯å£

**è§£å†³æ–¹æ¡ˆ**:
1. åœæ­¢æ‰€æœ‰æ‰‹åŠ¨å¯åŠ¨çš„Flaskè¿›ç¨‹
2. ç»Ÿä¸€ä½¿ç”¨systemdç®¡ç†åç«¯æœåŠ¡
3. é…ç½®è‡ªåŠ¨é‡å¯å’Œæ—¥å¿—ç®¡ç†

---

## ğŸ—ï¸ éƒ¨ç½²æ¶æ„

### ç½‘ç»œæ¶æ„
```
Internet
    â†“
Nginx (443/80)
    â†“
    â”œâ”€â”€ / (é™æ€æ–‡ä»¶) â†’ /var/www/lingzhiapp/public
    â”‚   â”œâ”€â”€ index.html
    â”‚   â”œâ”€â”€ assets/*.js
    â”‚   â””â”€â”€ assets/*.css
    â”‚
    â””â”€â”€ /api/* (APIä»£ç†) â†’ Flask Backend (8080)
        â”œâ”€â”€ /api/status
        â”œâ”€â”€ /api/health
        â”œâ”€â”€ /api/chat
        â””â”€â”€ /api/v9/*
```

### æœåŠ¡æ¶æ„
```
Systemd Services
â”œâ”€â”€ lingzhi-api.service (8080)
â”‚   â””â”€â”€ Flask Backend
â”‚       â”œâ”€â”€ SQLite Database
â”‚       â”œâ”€â”€ Auto Backup
â”‚       â””â”€â”€ v9.0 APIs
â”‚
â””â”€â”€ nginx.service (443/80)
    â”œâ”€â”€ SSL Certificate (Let's Encrypt)
    â”œâ”€â”€ Static File Serving
    â””â”€â”€ API Proxy
```

---

## âœ… åŠŸèƒ½éªŒè¯æ¸…å•

### åŸŸåä¸ç½‘ç»œ
- [x] HTTPSè®¿é—®: https://meiyueart.com
- [x] HTTPè‡ªåŠ¨é‡å®šå‘åˆ°HTTPS (301)
- [x] SSLè¯ä¹¦æœ‰æ•ˆ
- [x] CORSè·¨åŸŸé…ç½®

### å‰ç«¯åº”ç”¨
- [x] Reactå…¥å£é¡µé¢åŠ è½½
- [x] JavaScriptèµ„æºåŠ è½½ (290KB)
- [x] CSSèµ„æºåŠ è½½ (34KB)
- [x] å›¾æ ‡èµ„æºåŠ è½½
- [x] SPAè·¯ç”±æ”¯æŒ (/chat, /profileç­‰)

### åç«¯æœåŠ¡
- [x] FlaskæœåŠ¡è¿è¡Œåœ¨8080ç«¯å£
- [x] systemdè‡ªåŠ¨ç®¡ç†
- [x] è‡ªåŠ¨é‡å¯æœºåˆ¶
- [x] æ—¥å¿—è®°å½•

### APIæ¥å£
- [x] GET /api/status - è¿”å›æœåŠ¡çŠ¶æ€
- [x] GET /api/health - å¥åº·æ£€æŸ¥
- [x] POST /api/chat - æ™ºèƒ½ä½“å¯¹è¯
- [x] GET /api/v9/* - v9.0æ¥å£ç¾¤

### æ•°æ®åº“
- [x] SQLiteæ•°æ®åº“åˆ›å»º (508KB)
- [x] è‡ªåŠ¨å¤‡ä»½æœºåˆ¶
- [x] æ•°æ®æŒä¹…åŒ–

---

## ğŸ“ å…³é”®æ–‡ä»¶ä¸é…ç½®

### Nginxé…ç½®
**æ–‡ä»¶**: `/etc/nginx/sites-available/meiyueart.com`

**å…³é”®é…ç½®**:
- æ ¹è·¯å¾„: ç›´æ¥æä¾›é™æ€æ–‡ä»¶
- APIè·¯å¾„: ä»£ç†åˆ°8080ç«¯å£
- SSLè¯ä¹¦: Let's Encrypt
- CORS: å…¨éƒ¨å…è®¸

### SystemdæœåŠ¡
**æ–‡ä»¶**: `/etc/systemd/system/lingzhi-api.service`

**å…³é”®é…ç½®**:
- å·¥ä½œç›®å½•: /var/www/backend
- å¯åŠ¨å‘½ä»¤: /usr/local/python3.13/bin/python3.13 app.py
- è‡ªåŠ¨é‡å¯: Restart=always

### å‰ç«¯é™æ€æ–‡ä»¶
**ç›®å½•**: `/var/www/lingzhiapp/public/`
- index.html
- assets/index-BWCL-v89.js (290KB)
- assets/index-qrsY6l9I.css (34KB)
- icon-192x192.svg
- icon-512x512.svg

### åç«¯æœåŠ¡
**ç›®å½•**: `/var/www/backend/`
- app.py - Flaskåº”ç”¨
- lingzhi_ecosystem.db - SQLiteæ•°æ®åº“
- backups/ - è‡ªåŠ¨å¤‡ä»½ç›®å½•

---

## ğŸ” ç›‘æ§ä¸ç»´æŠ¤

### æœåŠ¡çŠ¶æ€æ£€æŸ¥
```bash
# æ£€æŸ¥NginxçŠ¶æ€
sudo systemctl status nginx

# æ£€æŸ¥APIæœåŠ¡çŠ¶æ€
sudo systemctl status lingzhi-api.service

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
sudo journalctl -u lingzhi-api.service -f

# æŸ¥çœ‹Nginxæ—¥å¿—
sudo tail -f /var/log/nginx/access.log
sudo tail -f /var/log/nginx/error.log
```

### å¥åº·æ£€æŸ¥
```bash
# æ£€æŸ¥APIçŠ¶æ€
curl https://meiyueart.com/api/status

# æ£€æŸ¥å¥åº·çŠ¶æ€
curl https://meiyueart.com/api/health

# æ£€æŸ¥åŸŸåè®¿é—®
curl -I https://meiyueart.com
```

### æ•°æ®åº“å¤‡ä»½
```bash
# æŸ¥çœ‹å¤‡ä»½æ–‡ä»¶
ls -lh /var/www/backend/backups/

# æ‰‹åŠ¨å¤‡ä»½
cp /var/www/backend/lingzhi_ecosystem.db /var/www/backend/backups/manual_backup_$(date +%Y%m%d_%H%M%S).db
```

---

## ğŸš€ éƒ¨ç½²å‘½ä»¤é€ŸæŸ¥

### å¯åŠ¨æœåŠ¡
```bash
# å¯åŠ¨Nginx
sudo systemctl start nginx

# å¯åŠ¨APIæœåŠ¡
sudo systemctl start lingzhi-api.service

# è®¾ç½®å¼€æœºè‡ªå¯
sudo systemctl enable nginx
sudo systemctl enable lingzhi-api.service
```

### é‡å¯æœåŠ¡
```bash
# é‡å¯Nginx
sudo systemctl restart nginx

# é‡å¯APIæœåŠ¡
sudo systemctl restart lingzhi-api.service
```

### æŸ¥çœ‹æ—¥å¿—
```bash
# æŸ¥çœ‹APIæœåŠ¡æ—¥å¿—
sudo journalctl -u lingzhi-api.service -n 50

# æŸ¥çœ‹Nginxé”™è¯¯æ—¥å¿—
sudo tail -n 50 /var/log/nginx/error.log
```

---

## ğŸ“ åç»­ä¼˜åŒ–å»ºè®®

### çŸ­æœŸä¼˜åŒ–ï¼ˆ1-2å‘¨ï¼‰
1. **ç›‘æ§å‘Šè­¦**: é…ç½®æœåŠ¡å¼‚å¸¸ç›‘æ§
2. **æ—¥å¿—åˆ†æ**: å»ºç«‹æ—¥å¿—åˆ†ææœºåˆ¶
3. **æ€§èƒ½ä¼˜åŒ–**: å¯ç”¨Gzipå‹ç¼©
4. **ç¼“å­˜ç­–ç•¥**: é…ç½®é™æ€èµ„æºç¼“å­˜

### ä¸­æœŸä¼˜åŒ–ï¼ˆ1ä¸ªæœˆï¼‰
1. **æ•°æ®åº“ä¼˜åŒ–**: è¯„ä¼°è¿ç§»åˆ°PostgreSQL
2. **è´Ÿè½½å‡è¡¡**: éƒ¨ç½²å¤šå®ä¾‹è´Ÿè½½å‡è¡¡
3. **CDNåŠ é€Ÿ**: ä½¿ç”¨CDNåˆ†å‘é™æ€èµ„æº
4. **å®‰å…¨åŠ å›º**: é…ç½®WAFé˜²ç«å¢™

### é•¿æœŸè§„åˆ’ï¼ˆ3ä¸ªæœˆ+ï¼‰
1. **å¾®æœåŠ¡æ‹†åˆ†**: å°†APIæœåŠ¡æ‹†åˆ†ä¸ºå¾®æœåŠ¡
2. **å®¹å™¨åŒ–éƒ¨ç½²**: ä½¿ç”¨Dockerå®¹å™¨åŒ–
3. **è‡ªåŠ¨åŒ–éƒ¨ç½²**: å»ºç«‹CI/CDæµç¨‹
4. **æ•°æ®å¤‡ä»½**: å»ºç«‹å¼‚åœ°å¤‡ä»½æœºåˆ¶

---

## ğŸ¯ v9.0 åŠŸèƒ½å¼€å‘å»ºè®®

æ ¹æ®[çµå€¼æ™ºèƒ½ä½“v9.0-å…¨é¢å‡çº§è®¾è®¡æ–¹æ¡ˆ.md]ï¼Œä»¥ä¸‹åŠŸèƒ½å¾…å¼€å‘ï¼š

### æ ¸å¿ƒåŠŸèƒ½
1. **ç”¨æˆ·è®¤è¯ç³»ç»Ÿ**
   - æ³¨å†Œã€ç™»å½•ã€ç™»å‡º
   - JWT tokenç®¡ç†
   - æƒé™æ§åˆ¶

2. **æ™ºèƒ½ä½“å¯¹è¯**
   - å¤šè½®å¯¹è¯æ”¯æŒ
   - å¯¹è¯å†å²è®°å½•
   - ä¸Šä¸‹æ–‡ç†è§£

3. **çŸ¥è¯†åº“ç®¡ç†**
   - çŸ¥è¯†ä¸Šä¼ 
   - å‘é‡åŒ–å­˜å‚¨
   - è¯­ä¹‰æœç´¢

4. **å…¬å¸åŠ¨æ€**
   - åŠ¨æ€å‘å¸ƒ
   - å›¾ç‰‡ä¸Šä¼ 
   - è¯„è®ºäº’åŠ¨

### v9.0 æ–°åŠŸèƒ½
1. **èµ„æºåŒ¹é…ç³»ç»Ÿ**
2. **å˜ç°ç”Ÿæ€**
3. **æ¨èç³»ç»Ÿ**
4. **ç§¯åˆ†ç³»ç»Ÿ**

---

## ğŸ“ æ•…éšœæ’æŸ¥æŒ‡å—

### åŸŸåæ— æ³•è®¿é—®
1. æ£€æŸ¥NginxæœåŠ¡çŠ¶æ€
2. æ£€æŸ¥SSLè¯ä¹¦æœ‰æ•ˆæœŸ
3. æ£€æŸ¥DNSè§£æ

### APIæ— å“åº”
1. æ£€æŸ¥APIæœåŠ¡çŠ¶æ€
2. æ£€æŸ¥8080ç«¯å£ç›‘å¬
3. æŸ¥çœ‹æœåŠ¡æ—¥å¿—

### é™æ€èµ„æº404
1. æ£€æŸ¥æ–‡ä»¶æƒé™
2. æ£€æŸ¥Nginx rootè·¯å¾„
3. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸Šä¼ 

---

## ğŸ‰ éƒ¨ç½²æ€»ç»“

âœ… **åŸŸåè®¿é—®æ­£å¸¸**: https://meiyueart.com è¿”å›Reactåº”ç”¨
âœ… **APIæœåŠ¡ç¨³å®š**: systemdç®¡ç†ï¼Œè‡ªåŠ¨é‡å¯
âœ… **æ•°æ®æŒä¹…åŒ–**: SQLiteæ•°æ®åº“ + è‡ªåŠ¨å¤‡ä»½
âœ… **HTTPSå®‰å…¨**: Let's Encrypt SSLè¯ä¹¦
âœ… **ç«¯å£æ— å†²çª**: 8080ç«¯å£æ­£å¸¸è¿è¡Œ

**éƒ¨ç½²ç”¨æ—¶**: çº¦3å°æ—¶
**é—®é¢˜ä¿®å¤**: 2ä¸ªä¸»è¦é—®é¢˜
**æœåŠ¡çŠ¶æ€**: å…¨éƒ¨æ­£å¸¸è¿è¡Œ

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2026-02-05 11:16
**æŠ¥å‘Šç”Ÿæˆè€…**: Coze Coding Agent
**éƒ¨ç½²ç¯å¢ƒ**: ç”Ÿäº§ç¯å¢ƒ
