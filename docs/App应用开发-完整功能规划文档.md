# 灵值生态园 App - 完整功能规划文档

**版本**: v1.0
**创建日期**: 2025年1月15日
**主体公司**: 陕西媄月商业艺术有限责任公司
**文档类型**: App功能规划文档

---

## 📋 目录

1. [项目概述](#一项目概述)
2. [功能架构](#二功能架构)
3. [页面结构设计](#三页面结构设计)
4. [功能模块详解](#四功能模块详解)
5. [页面功能映射](#五页面功能映射)
6. [交互流程设计](#六交互流程设计)
7. [数据流设计](#七数据流设计)
8. [安全设计](#八安全设计)
9. [性能优化](#九性能优化)
10. [开发计划](#十开发计划)

---

## 一、项目概述

### 1.1 项目背景

灵值生态园是一个基于AI智能体的情绪价值平台，核心功能是为用户提供情绪识别、情感支持、成长建议等服务。随着业务的不断发展，需要开发一个移动端App，为用户提供更便捷的使用体验。

### 1.2 项目目标

#### 短期目标（3个月）

- ✅ 完成核心功能开发（P0级别）
- ✅ 上线v1.0版本
- ✅ 建立稳定的技术架构

#### 中期目标（6个月）

- ✅ 完成重要功能开发（P1级别）
- ✅ 增强功能开发（P2级别）
- ✅ 用户数达到10,000+

#### 长期目标（12个月）

- ✅ 完成管理功能（P3级别）
- ✅ 用户数达到50,000+
- ✅ 建立完善的运营体系

### 1.3 核心价值

| 价值维度 | 具体体现 |
|---------|---------|
| **情绪价值** | 情绪识别、理解、陪伴、支持、引导 |
| **智能价值** | AI智能对话、个性化建议、知识分享 |
| **经济价值** | 灵值激励机制、现金兑换能力、推荐奖励 |
| **社交价值** | 社区互动、推荐关系、共同成长 |

### 1.4 目标用户

| 用户类型 | 特征 | 需求 |
|---------|------|------|
| **职场人士** | 工作压力大，需要情绪支持 | 情绪宣泄、压力管理 |
| **学生群体** | 学业压力，需要成长指导 | 学习建议、情绪调节 |
| **宝妈群体** | 育儿压力，需要情感支持 | 情绪陪伴、育儿建议 |
| **创业者** | 工作压力大，需要情绪管理 | 情绪记录、压力释放 |

---

## 二、功能架构

### 2.1 功能模块图

```
┌─────────────────────────────────────────────────────────┐
│                   灵值生态园 App                          │
└─────────────────────────────────────────────────────────┘
                          │
    ┌─────────────────────┼─────────────────────┐
    │                     │                     │
┌───▼────┐          ┌────▼────┐          ┌────▼────┐
│ 用户系统 │          │ 情绪系统 │          │ 智能对话 │
└───┬────┘          └────┬────┘          └────┬────┘
    │                     │                     │
┌───▼────┐          ┌────▼────┐          ┌────▼────┐
│ 签到系统 │          │ 财务系统 │          │ 知识系统 │
└───┬────┘          └────┬────┘          └────┬────┘
    │                     │                     │
┌───▼────┐          ┌────▼────┐          ┌────▼────┐
│ 个人中心 │          │ 公司动态 │          │ 系统设置 │
└────────┘          └────────┘          └────────┘
```

### 2.2 功能模块列表

| 序号 | 模块名称 | 功能数量 | 优先级 |
|------|---------|---------|--------|
| 1 | 用户系统 | 8个 | P0 |
| 2 | 情绪系统 | 6个 | P0 |
| 3 | 智能对话 | 5个 | P0 |
| 4 | 签到系统 | 4个 | P1 |
| 5 | 财务系统 | 5个 | P1 |
| 6 | 个人中心 | 5个 | P1 |
| 7 | 公司动态 | 4个 | P2 |
| 8 | 知识系统 | 2个 | P2 |
| 9 | 系统设置 | 8个 | P2 |
| **总计** | **9个模块** | **47个功能** | - |

---

## 三、页面结构设计

### 3.1 页面树状图

```
灵值生态园 App
├── 1. 启动页 (SplashScreen)
├── 2. 登录/注册页 (LoginScreen)
├── 3. 首页/主页面 (HomeScreen)
│   ├── 3.1 情绪记录快捷入口
│   ├── 3.2 智能对话入口
│   ├── 3.3 签到入口
│   ├── 3.4 情绪统计卡片
│   └── 3.5 公司动态入口
├── 4. 智能对话页 (ChatScreen)
│   ├── 4.1 对话历史
│   ├── 4.2 消息输入框
│   └── 4.3 对话设置
├── 5. 情绪记录页 (EmotionRecordScreen)
│   ├── 5.1 情绪类型选择
│   ├── 5.2 情绪强度调节
│   ├── 5.3 情绪上下文输入
│   └── 5.4 情绪历史列表
├── 6. 情绪统计页 (EmotionStatisticsScreen)
│   ├── 6.1 情绪分布图
│   ├── 6.2 情绪趋势图
│   ├── 6.3 情绪模式分析
│   └── 6.4 时间周期选择
├── 7. 情绪日记页 (EmotionDiaryScreen)
│   ├── 7.1 日记列表
│   ├── 7.2 创建日记
│   ├── 7.3 编辑日记
│   ├── 7.4 查看日记详情
│   └── 7.5 日记标签管理
├── 8. 签到页 (CheckInScreen)
│   ├── 8.1 签到按钮
│   ├── 8.2 签到历史
│   ├── 8.3 签到统计
│   └── 8.4 签到奖励说明
├── 9. 个人中心页 (ProfileScreen)
│   ├── 9.1 用户信息展示
│   ├── 9.2 头像设置
│   ├── 9.3 灵值余额
│   ├── 9.4 签到记录
│   └── 9.5 灵值明细
├── 10. 财务中心页 (WalletScreen)
│   ├── 10.1 灵值余额展示
│   ├── 10.2 灵值明细查询
│   ├── 10.3 灵值兑换
│   ├── 10.4 提现申请
│   └── 10.5 提现记录
├── 11. 公司动态页 (NewsScreen)
│   ├── 11.1 动态列表
│   ├── 11.2 动态详情
│   ├── 11.3 动态点赞
│   └── 11.4 动态评论
├── 12. 设置页 (SettingsScreen)
│   ├── 12.1 账号设置
│   ├── 12.2 修改密码
│   ├── 12.3 双因素认证
│   ├── 12.4 隐私设置
│   ├── 12.5 对话设置
│   ├── 12.6 关于我们
│   ├── 12.7 帮助与反馈
│   └── 12.8 退出登录
└── 13. 实名认证页 (RealNameAuthScreen)
    ├── 13.1 真实姓名输入
    ├── 13.2 身份证号输入
    ├── 13.3 身份证照片上传
    └── 13.4 认证结果
```

### 3.2 页面统计

| 类别 | 页面数量 | 说明 |
|------|---------|------|
| **核心页面** | 5个 | 首页、对话、情绪记录、情绪统计、情绪日记 |
| **用户页面** | 4个 | 登录、个人中心、财务、实名认证 |
| **功能页面** | 3个 | 签到、公司动态、设置 |
| **总计** | **12个主页面** | 包含13个详细页面 |

---

## 四、功能模块详解

### 4.1 用户系统模块

#### 4.1.1 功能列表

| 序号 | 功能名称 | 功能描述 | API接口 | 优先级 |
|------|---------|---------|---------|--------|
| 1 | 用户注册 | 通过邮箱注册账号 | POST /api/user/register | P0 |
| 2 | 用户登录 | 邮箱+密码登录 | POST /api/user/login | P0 |
| 3 | 自动注册登录 | 首次使用自动创建账户 | POST /api/user/auto-login | P0 |
| 4 | 登录状态管理 | Token认证，保持登录状态 | GET /api/user/status | P0 |
| 5 | 用户信息管理 | 编辑个人信息 | PUT /api/user/profile | P0 |
| 6 | 实名认证 | 身份证信息验证 | POST /api/user/realname-auth | P0 |
| 7 | 收款方式管理 | 添加/编辑收款方式 | PUT /api/user/payment-method | P0 |
| 8 | 密码管理 | 修改登录密码 | PUT /api/user/password | P0 |

#### 4.1.2 用户信息字段

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| name | String | 是 | 用户姓名 |
| email | String | 是 | 邮箱（唯一） |
| password | String | 是 | 密码（加密存储） |
| phone | String | 否 | 电话 |
| wechat | String | 否 | 微信号 |
| real_name | String | 否 | 真实姓名 |
| id_card | String | 否 | 身份证号码 |
| avatar | String | 否 | 头像URL |

---

### 4.2 情绪系统模块（核心）

#### 4.2.1 功能列表

| 序号 | 功能名称 | 功能描述 | API接口 | 优先级 |
|------|---------|---------|---------|--------|
| 1 | 情绪识别 | 识别用户文本中的情绪 | POST /api/emotion/detect | P0 |
| 2 | 情绪记录 | 保存用户情绪到数据库 | POST /api/emotion/record | P0 |
| 3 | 情绪统计 | 统计用户情绪分布 | GET /api/emotion/statistics | P0 |
| 4 | 情绪日记 | 创建/编辑/查看情绪日记 | POST /api/emotion/diary | P0 |
| 5 | 情绪历史 | 查询情绪历史记录 | GET /api/emotion/history | P0 |
| 6 | 情绪模式分析 | 分析用户情绪模式 | GET /api/emotion/pattern | P0 |

#### 4.2.2 情绪类型

| 情绪类型 | 中文 | emoji | 说明 |
|---------|------|-------|------|
| joy | 开心 | 😊 | 积极、愉快的情绪 |
| sadness | 悲伤 | 😢 | 消极、难过的情绪 |
| anger | 愤怒 | 😠 | 不满、愤怒的情绪 |
| anxiety | 焦虑 | 😰 | 担心、紧张的情绪 |
| surprise | 惊讶 | 😲 | 意外、震惊的情绪 |
| neutral | 平静 | 😌 | 平稳、正常的情绪 |

#### 4.2.3 情绪强度

- **范围**: 0.0 - 1.0
- **等级划分**:
  - 0.0 - 0.2: 轻微
  - 0.2 - 0.4: 较轻
  - 0.4 - 0.6: 中等
  - 0.6 - 0.8: 较强
  - 0.8 - 1.0: 强烈

---

### 4.3 智能对话模块（核心）

#### 4.3.1 功能列表

| 序号 | 功能名称 | 功能描述 | API接口 | 优先级 |
|------|---------|---------|---------|--------|
| 1 | 智能对话 | 与灵值智能心灵伙伴对话 | POST /api/chat/send | P0 |
| 2 | 对话历史 | 查询对话历史记录 | GET /api/chat/history | P0 |
| 3 | 情绪识别与共情 | 自动识别情绪并共情回应 | - | P0 |
| 4 | 成长建议 | 提供6类成长建议 | - | P0 |
| 5 | 对话设置 | 个性化对话设置 | PUT /api/chat/settings | P1 |

#### 4.3.2 对话类型

| 对话类型 | 说明 | 应用场景 |
|---------|------|---------|
| **情绪倾诉** | 用户表达情绪，灵值提供共情 | 工作压力大、遇到挫折 |
| **寻求建议** | 用户寻求建议，灵值提供引导 | 职业规划、人际关系 |
| **分享喜悦** | 用户分享快乐，灵值一起庆祝 | 取得成就、好事发生 |
| **迷茫焦虑** | 用户表达迷茫，灵值提供安慰 | 未来规划、选择困难 |

---

### 4.4 签到系统模块

#### 4.4.1 功能列表

| 序号 | 功能名称 | 功能描述 | API接口 | 优先级 |
|------|---------|---------|---------|--------|
| 1 | 每日签到 | 用户每天签到一次 | POST /api/checkin | P1 |
| 2 | 签到历史查询 | 查询签到历史记录 | GET /api/checkin/history | P1 |
| 3 | 今日签到状态 | 查询今日是否已签到 | GET /api/checkin/today | P1 |
| 4 | 签到统计 | 统计总次数和连续天数 | GET /api/checkin/statistics | P1 |

#### 4.4.2 签到奖励规则

| 签到类型 | 奖励 | 说明 |
|---------|------|------|
| 单次签到 | +10 灵值 | 每天签到获得10灵值 |
| 连续3天 | 额外+5 灵值 | 连续签到3天额外奖励 |
| 连续7天 | 额外+15 灵值 | 连续签到7天额外奖励 |
| 连续30天 | 额外+50 灵值 | 连续签到30天额外奖励 |

---

### 4.5 财务系统模块

#### 4.5.1 功能列表

| 序号 | 功能名称 | 功能描述 | API接口 | 优先级 |
|------|---------|---------|---------|--------|
| 1 | 灵值查看 | 查看灵值余额 | GET /api/wallet/balance | P1 |
| 2 | 灵值明细查询 | 查询灵值收支明细 | GET /api/wallet/transactions | P1 |
| 3 | 灵值兑换 | 兑换灵值为现金 | POST /api/wallet/exchange | P1 |
| 4 | 提现申请 | 申请提现到收款账户 | POST /api/wallet/withdraw | P1 |
| 5 | 提现记录 | 查询提现申请记录 | GET /api/wallet/withdrawals | P1 |

#### 4.5.2 灵值获取方式

| 获取方式 | 数量 | 说明 |
|---------|------|------|
| 每日签到 | +10 | 每天签到获得10灵值 |
| 连续签到 | 额外+5~50 | 连续签到额外奖励 |
| 情绪日记 | +5 | 每写一篇日记获得5灵值 |
| 推荐好友 | +100 | 推荐好友注册获得100灵值 |
| 系统奖励 | 不定 | 活动奖励、任务奖励 |

#### 4.5.3 灵值兑换规则

| 兑换金额 | 需要灵值 | 说明 |
|---------|---------|------|
| 10元 | 1000灵值 | 100灵值=1元 |
| 50元 | 5000灵值 | 100灵值=1元 |
| 100元 | 10000灵值 | 100灵值=1元 |

---

### 4.6 个人中心模块

#### 4.6.1 功能列表

| 序号 | 功能名称 | 功能描述 | API接口 | 优先级 |
|------|---------|---------|---------|--------|
| 1 | 个人信息展示 | 展示用户基本信息 | GET /api/user/profile | P1 |
| 2 | 个人信息编辑 | 编辑用户个人信息 | PUT /api/user/profile | P1 |
| 3 | 头像上传 | 上传用户头像 | POST /api/user/avatar | P1 |
| 4 | 签到记录查询 | 查询签到历史 | GET /api/checkin/history | P1 |
| 5 | 灵值记录查询 | 查询灵值明细 | GET /api/wallet/transactions | P1 |

---

### 4.7 公司动态模块

#### 4.7.1 功能列表

| 序号 | 功能名称 | 功能描述 | API接口 | 优先级 |
|------|---------|---------|---------|--------|
| 1 | 查看动态列表 | 查看所有公司动态 | GET /api/dynamics | P2 |
| 2 | 查看动态详情 | 查看动态详细内容 | GET /api/dynamics/:id | P2 |
| 3 | 动态点赞 | 对动态进行点赞 | POST /api/dynamics/:id/like | P2 |
| 4 | 动态评论 | 对动态进行评论 | POST /api/dynamics/:id/comment | P2 |

---

### 4.8 知识系统模块

#### 4.8.1 功能列表

| 序号 | 功能名称 | 功能描述 | API接口 | 优先级 |
|------|---------|---------|---------|--------|
| 1 | 知识库检索 | 搜索知识库内容 | POST /api/knowledge/search | P2 |
| 2 | 联网搜索 | 搜索互联网内容 | POST /api/web/search | P2 |

---

### 4.9 系统设置模块

#### 4.9.1 功能列表

| 序号 | 功能名称 | 功能描述 | API接口 | 优先级 |
|------|---------|---------|---------|--------|
| 1 | 账号设置 | 修改账号信息 | PUT /api/user/account | P2 |
| 2 | 修改密码 | 修改登录密码 | PUT /api/user/password | P2 |
| 3 | 双因素认证 | 启用/禁用双因素认证 | PUT /api/user/2fa | P2 |
| 4 | 隐私设置 | 设置隐私选项 | PUT /api/user/privacy | P2 |
| 5 | 对话设置 | 设置对话偏好 | PUT /api/chat/settings | P2 |
| 6 | 关于我们 | 查看公司介绍 | GET /api/about | P2 |
| 7 | 帮助与反馈 | 提交问题和反馈 | POST /api/feedback | P2 |
| 8 | 退出登录 | 退出当前账号 | POST /api/user/logout | P2 |

---

## 五、页面功能映射

### 5.1 核心页面映射

#### 5.1.1 首页 (HomeScreen)

| 功能区域 | 功能 | 详细说明 | API接口 |
|---------|------|---------|---------|
| 顶部导航 | 用户信息展示 | 显示头像、昵称、灵值余额 | GET /api/user/profile |
| 情绪记录入口 | 快速记录情绪 | 点击跳转到情绪记录页 | - |
| 智能对话入口 | 与灵值对话 | 点击跳转到智能对话页 | - |
| 签到入口 | 每日签到 | 显示签到状态，点击签到 | GET /api/checkin/today<br>POST /api/checkin |
| 情绪统计卡片 | 情绪分布概览 | 显示情绪分布饼图 | GET /api/emotion/statistics |
| 公司动态入口 | 查看公司动态 | 显示最新3条动态 | GET /api/dynamics |

#### 5.1.2 智能对话页 (ChatScreen)

| 功能区域 | 功能 | 详细说明 | API接口 |
|---------|------|---------|---------|
| 对话历史 | 显示历史对话 | 显示最近的对话消息 | GET /api/chat/history |
| 消息输入框 | 输入消息 | 输入文本或语音 | POST /api/chat/send |
| 对话设置 | 设置对话偏好 | 调整对话风格、隐私设置 | PUT /api/chat/settings |
| 情绪识别 | 自动识别情绪 | 识别用户消息中的情绪 | POST /api/emotion/detect |
| 共情回应 | 提供共情回应 | 根据情绪提供4级共情 | - |

#### 5.1.3 情绪记录页 (EmotionRecordScreen)

| 功能区域 | 功能 | 详细说明 | API接口 |
|---------|------|---------|---------|
| 情绪类型选择 | 选择情绪类型 | 6种基础情绪选择 | - |
| 情绪强度调节 | 调节情绪强度 | 滑动条调节（0.0-1.0） | - |
| 情绪上下文输入 | 输入情绪上下文 | 文本框输入 | - |
| 提交按钮 | 保存情绪记录 | 提交到数据库 | POST /api/emotion/record |
| 情绪历史列表 | 查看历史记录 | 显示最近的情绪记录 | GET /api/emotion/history |

#### 5.1.4 情绪统计页 (EmotionStatisticsScreen)

| 功能区域 | 功能 | 详细说明 | API接口 |
|---------|------|---------|---------|
| 时间周期选择 | 选择统计周期 | 日/周/月 | - |
| 情绪分布图 | 显示情绪分布 | 饼图/柱状图显示 | GET /api/emotion/statistics |
| 情绪趋势图 | 显示情绪趋势 | 折线图显示 | GET /api/emotion/statistics |
| 情绪模式分析 | 分析情绪模式 | 文字说明 | GET /api/emotion/pattern |

#### 5.1.5 情绪日记页 (EmotionDiaryScreen)

| 功能区域 | 功能 | 详细说明 | API接口 |
|---------|------|---------|---------|
| 日记列表 | 显示所有日记 | 显示日记标题、日期、情绪 | GET /api/emotion/diary |
| 创建日记 | 新建日记 | 点击新建按钮 | - |
| 编辑日记 | 编辑现有日记 | 点击日记条目 | PUT /api/emotion/diary/:id |
| 查看详情 | 查看日记详情 | 点击日记条目 | GET /api/emotion/diary/:id |
| 删除日记 | 删除日记 | 长按删除 | DELETE /api/emotion/diary/:id |

---

### 5.2 用户页面映射

#### 5.2.1 登录/注册页 (LoginScreen)

| 功能区域 | 功能 | 详细说明 | API接口 |
|---------|------|---------|---------|
| 邮箱输入 | 输入邮箱 | 邮箱格式验证 | - |
| 密码输入 | 输入密码 | 密码强度验证 | - |
| 登录按钮 | 用户登录 | 提交登录请求 | POST /api/user/login |
| 注册按钮 | 用户注册 | 跳转到注册页 | POST /api/user/register |
| 自动登录 | 一键登录 | 自动注册并登录 | POST /api/user/auto-login |

#### 5.2.2 个人中心页 (ProfileScreen)

| 功能区域 | 功能 | 详细说明 | API接口 |
|---------|------|---------|---------|
| 用户信息展示 | 显示用户信息 | 头像、昵称、邮箱、电话 | GET /api/user/profile |
| 编辑信息 | 编辑个人信息 | 点击编辑按钮 | PUT /api/user/profile |
| 头像设置 | 上传头像 | 点击头像上传 | POST /api/user/avatar |
| 灵值余额 | 显示灵值余额 | 显示可用灵值 | GET /api/wallet/balance |
| 签到记录 | 查看签到记录 | 点击查看 | GET /api/checkin/history |
| 灵值明细 | 查看灵值明细 | 点击查看 | GET /api/wallet/transactions |

#### 5.2.3 财务中心页 (WalletScreen)

| 功能区域 | 功能 | 详细说明 | API接口 |
|---------|------|---------|---------|
| 灵值余额 | 显示灵值余额 | 显示可用灵值 | GET /api/wallet/balance |
| 灵值明细 | 查看灵值明细 | 显示收支明细列表 | GET /api/wallet/transactions |
| 灵值兑换 | 兑换灵值 | 选择兑换金额 | POST /api/wallet/exchange |
| 提现申请 | 申请提现 | 选择提现账户和金额 | POST /api/wallet/withdraw |
| 提现记录 | 查看提现记录 | 显示提现申请列表 | GET /api/wallet/withdrawals |

#### 5.2.4 实名认证页 (RealNameAuthScreen)

| 功能区域 | 功能 | 详细说明 | API接口 |
|---------|------|---------|---------|
| 真实姓名输入 | 输入真实姓名 | 姓名验证 | - |
| 身份证号输入 | 输入身份证号 | 身份证号验证 | - |
| 身份证照片上传 | 上传身份证照片 | 正反面照片 | POST /api/user/id-card |
| 提交认证 | 提交认证信息 | 提交到后台审核 | POST /api/user/realname-auth |
| 认证结果 | 显示认证状态 | 认证中/已通过/已拒绝 | GET /api/user/realname-auth |

---

### 5.3 功能页面映射

#### 5.3.1 签到页 (CheckInScreen)

| 功能区域 | 功能 | 详细说明 | API接口 |
|---------|------|---------|---------|
| 签到按钮 | 点击签到 | 每人每天一次 | POST /api/checkin |
| 签到状态 | 显示签到状态 | 今日是否已签到 | GET /api/checkin/today |
| 签到历史 | 查看签到历史 | 显示签到日历 | GET /api/checkin/history |
| 签到统计 | 显示签到统计 | 总次数、连续天数 | GET /api/checkin/statistics |
| 签到奖励 | 显示奖励规则 | 奖励规则说明 | - |

#### 5.3.2 公司动态页 (NewsScreen)

| 功能区域 | 功能 | 详细说明 | API接口 |
|---------|------|---------|---------|
| 动态列表 | 显示动态列表 | 显示所有公司动态 | GET /api/dynamics |
| 动态详情 | 查看动态详情 | 点击查看详情 | GET /api/dynamics/:id |
| 动态点赞 | 对动态点赞 | 点击点赞按钮 | POST /api/dynamics/:id/like |
| 动态评论 | 对动态评论 | 输入评论内容 | POST /api/dynamics/:id/comment |

#### 5.3.3 设置页 (SettingsScreen)

| 功能区域 | 功能 | 详细说明 | API接口 |
|---------|------|---------|---------|
| 账号设置 | 修改账号信息 | 邮箱、电话等 | PUT /api/user/account |
| 修改密码 | 修改登录密码 | 旧密码、新密码 | PUT /api/user/password |
| 双因素认证 | 启用/禁用2FA | 扫描二维码 | PUT /api/user/2fa |
| 隐私设置 | 设置隐私选项 | 隐私保护设置 | PUT /api/user/privacy |
| 对话设置 | 设置对话偏好 | 对话风格、隐私 | PUT /api/chat/settings |
| 关于我们 | 查看公司介绍 | 公司信息、版本 | GET /api/about |
| 帮助与反馈 | 提交问题和反馈 | 问题描述、联系方式 | POST /api/feedback |
| 退出登录 | 退出当前账号 | 清除Token | POST /api/user/logout |

---

## 六、交互流程设计

### 6.1 用户注册登录流程

```
用户打开App
  ↓
显示启动页（3秒）
  ↓
检查登录状态
  ↓
  ├─ 已登录 → 跳转到首页
  └─ 未登录 → 跳转到登录页
        ↓
    输入邮箱和密码
        ↓
    点击登录按钮
        ↓
    验证邮箱和密码
        ↓
    ├─ 验证成功 → 保存Token → 跳转到首页
    └─ 验证失败 → 显示错误提示 → 重新输入
```

### 6.2 情绪记录流程

```
用户点击"情绪记录"
  ↓
跳转到情绪记录页
  ↓
选择情绪类型（开心/悲伤/愤怒/焦虑/惊讶/平静）
  ↓
调节情绪强度（0.0-1.0）
  ↓
输入情绪上下文（可选）
  ↓
点击"提交"按钮
  ↓
保存情绪到数据库
  ↓
显示"记录成功"提示
  ↓
跳转到情绪历史页
```

### 6.3 智能对话流程

```
用户点击"智能对话"
  ↓
跳转到智能对话页
  ↓
输入消息
  ↓
点击"发送"按钮
  ↓
发送消息到后端
  ↓
后端调用灵值智能体
  ↓
智能体识别情绪
  ↓
智能体生成共情回应
  ↓
返回回应消息
  ↓
显示在对话历史中
```

### 6.4 签到流程

```
用户点击"签到"
  ↓
检查今日签到状态
  ↓
  ├─ 已签到 → 显示"今日已签到"
  └─ 未签到 → 显示签到按钮
        ↓
    点击"签到"按钮
        ↓
    发送签到请求
        ↓
    保存签到记录
        ↓
    发放灵值奖励
        ↓
    显示"签到成功，获得X灵值"
        ↓
    更新签到状态
```

### 6.5 灵值兑换流程

```
用户点击"灵值兑换"
  ↓
跳转到财务中心页
  ↓
查看灵值余额
  ↓
选择兑换金额（10元/50元/100元）
  ↓
检查灵值是否足够
  ↓
  ├─ 不足 → 显示"灵值不足"
  └─ 足够 → 显示确认弹窗
        ↓
    确认兑换
        ↓
    扣除灵值
        ↓
    发放现金到账户
        ↓
    显示"兑换成功"
        ↓
    更新灵值余额
```

---

## 七、数据流设计

### 7.1 情绪数据流

```
用户输入情绪信息
  ↓
前端发送 POST /api/emotion/record
  ↓
后端接收请求
  ↓
调用 EmotionManager.record_emotion()
  ↓
保存到 PostgreSQL (emotion_records 表)
  ↓
返回成功响应
  ↓
前端显示"记录成功"
```

### 7.2 智能对话数据流

```
用户输入消息
  ↓
前端发送 POST /api/chat/send
  ↓
后端接收请求
  ↓
调用 灵值智能体
  ↓
智能体调用 detect_emotion 识别情绪
  ↓
智能体根据情绪生成共情回应
  ↓
返回回应消息
  ↓
前端显示在对话历史中
```

### 7.3 签到数据流

```
用户点击签到
  ↓
前端发送 POST /api/checkin
  ↓
后端接收请求
  ↓
检查今日是否已签到
  ↓
  ├─ 已签到 → 返回"今日已签到"
  └─ 未签到 → 保存签到记录
        ↓
    发放灵值奖励
        ↓
    更新用户灵值余额
        ↓
    返回"签到成功，获得X灵值"
```

---

## 八、安全设计

### 8.1 认证安全

| 安全措施 | 说明 |
|---------|------|
| **Token认证** | 使用JWT Token进行身份认证 |
| **Token过期** | Token有效期为7天 |
| **密码加密** | 使用bcrypt加密存储密码 |
| **双因素认证** | 支持启用2FA增强安全性 |

### 8.2 数据安全

| 安全措施 | 说明 |
|---------|------|
| **HTTPS传输** | 所有数据传输使用HTTPS加密 |
| **敏感信息加密** | 身份证号、银行卡号等敏感信息加密存储 |
| **数据脱敏** | 日志中敏感信息脱敏处理 |
| **权限控制** | 用户只能访问自己的数据 |

### 8.3 隐私保护

| 隐私措施 | 说明 |
|---------|------|
| **隐私设置** | 用户可设置隐私选项 |
| **数据导出** | 用户可导出自己的数据 |
| **数据删除** | 用户可申请删除账户和数据 |
| **隐私政策** | 明确的隐私政策和用户协议 |

---

## 九、性能优化

### 9.1 前端优化

| 优化措施 | 说明 |
|---------|------|
| **图片懒加载** | 列表图片懒加载 |
| **列表分页** | 长列表分页加载 |
| **缓存策略** | 使用缓存减少网络请求 |
| **代码分割** | 按需加载模块 |

### 9.2 后端优化

| 优化措施 | 说明 |
|---------|------|
| **Redis缓存** | 热点数据缓存 |
| **数据库索引** | 为常用查询字段创建索引 |
| **分页查询** | 列表数据分页返回 |
| **异步任务** | 耗时任务异步处理 |

---

## 十、开发计划

### 10.1 开发阶段

| 阶段 | 时间 | 内容 | 交付物 |
|------|------|------|--------|
| **第一阶段** | 第1-4周 | 核心功能开发 | P0功能完成 |
| **第二阶段** | 第5-8周 | 重要功能开发 | P1功能完成 |
| **第三阶段** | 第9-10周 | 测试与优化 | 测试报告 |
| **第四阶段** | 第11-12周 | 上线与部署 | v1.0版本上线 |

### 10.2 功能优先级

| 优先级 | 功能模块 | 功能数量 | 完成时间 |
|--------|---------|---------|---------|
| **P0** | 用户系统、情绪系统、智能对话 | 19个 | 第4周 |
| **P1** | 签到系统、财务系统、个人中心 | 14个 | 第8周 |
| **P2** | 公司动态、知识系统、系统设置 | 14个 | 第12周 |

### 10.3 里程碑

| 里程碑 | 时间 | 目标 |
|--------|------|------|
| **M1** | 第4周 | P0功能完成，内部测试 |
| **M2** | 第8周 | P1功能完成，Beta测试 |
| **M3** | 第10周 | 所有功能完成，全面测试 |
| **M4** | 第12周 | v1.0版本上线 |

---

## 十一、总结

### 11.1 功能统计

| 项目 | 数量 |
|------|------|
| **功能模块** | 9个 |
| **页面总数** | 12个主页面（13个详细页面） |
| **功能总数** | 47个 |
| **API接口** | 50+ |

### 11.2 核心亮点

1. **情绪价值导向**：专注于情绪识别、理解和支持
2. **AI智能驱动**：基于灵值智能体，提供智能化服务
3. **完善的功能体系**：9大模块，覆盖用户全生命周期
4. **个性化服务**：长期记忆，记住用户偏好和经历
5. **经济激励机制**：灵值奖励，增强用户粘性

### 11.3 技术架构

| 层级 | 技术选型 |
|------|---------|
| **前端** | React Native |
| **后端** | Python Flask |
| **数据库** | PostgreSQL |
| **缓存** | Redis |
| **AI服务** | 豆包大模型 + LangChain + LangGraph |

---

**文档版本**: v1.0
**创建日期**: 2025年1月15日
**维护团队**: 陕西媄月商业艺术有限责任公司技术部
