# 灵值生态园 App - 缺失模块补充

**版本**: v1.1
**更新日期**: 2025年1月15日
**问题**: 之前的规划遗漏了重要的业务模块

---

## 一、遗漏的模块清单

### 从数据库表分析，发现以下模块被遗漏：

| 序号 | 模块名称 | 数据库表 | 优先级 | 说明 |
|------|---------|---------|-------|------|
| 1 | 推荐关系系统 | ReferralRelations | P2 | 推荐人管理、推荐奖励 |
| 2 | 角色权限系统 | Roles, Permissions | P3 | 用户角色、权限管理 |
| 3 | 审计日志系统 | AuditLogs | P3 | 操作日志、安全审计 |
| 4 | 公司信息系统 | CompanyInfo | P3 | 公司信息管理 |
| 5 | 会话管理系统 | Sessions | P0 | 用户会话、登录状态 |
| 6 | 财务交易系统 | FinancialTransactions | P1 | 财务交易记录 |
| 7 | 灵值兑换系统 | ContributionValueExchanges | P2 | 灵值兑换记录 |

---

## 二、遗漏模块详细说明

### 1. 推荐关系系统 ⚠️ 重要遗漏

**数据库表**: `ReferralRelations`

**核心功能**：
- ✅ 推荐关系管理（推荐人、被推荐人）
- ✅ 推荐层级管理（1级、2级、3级）
- ✅ 推荐奖励机制
- ✅ 推荐关系状态管理（active/inactive）

**业务价值**：
- 用户增长
- 社交裂变
- 激励机制

**App页面需求**：
- **推荐页** - 显示我的推荐人、我推荐的人、推荐奖励
- **邀请页** - 生成邀请码、分享邀请链接
- **推荐奖励页** - 查看推荐奖励记录

**优先级**: P2（v1.2实现）

---

### 2. 角色权限系统 ⚠️ 管理员功能遗漏

**数据库表**: `Roles`, `Permissions`, `user_roles`, `role_permissions`

**核心功能**：
- ✅ 角色管理（超级管理员、CEO、高级管理员、普通用户）
- ✅ 权限管理（用户管理、财务管理、内容管理等权限）
- ✅ 角色分配
- ✅ 权限验证

**业务价值**：
- 权限控制
- 安全管理
- 多角色支持

**App页面需求**（仅管理员）：
- **角色管理页** - 管理员查看和编辑用户角色
- **权限管理页** - 管理员配置权限

**优先级**: P3（v1.3实现）

---

### 3. 审计日志系统 ⚠️ 安全功能遗漏

**数据库表**: `AuditLogs`

**核心功能**：
- ✅ 操作日志记录（登录、修改、删除等操作）
- ✅ 操作类型分类（user_action, admin_action等）
- ✅ 操作状态记录（success/failed）
- ✅ IP地址和用户代理记录

**业务价值**：
- 安全审计
- 操作追溯
- 异常检测

**App页面需求**（仅管理员）：
- **审计日志页** - 管理员查看操作日志

**优先级**: P3（v1.3实现）

---

### 4. 公司信息系统 ⚠️ 基础信息遗漏

**数据库表**: `CompanyInfo`

**核心功能**：
- ✅ 公司信息管理（公司名称、税号、地址、电话）
- ✅ 银行信息管理（银行名称、银行账号）
- ✅ 公司状态管理（active/inactive）

**业务价值**：
- 公司信息展示
- 财务管理基础
- 法律合规

**App页面需求**：
- **公司信息页** - 显示公司基本信息

**优先级**: P3（v1.3实现）

---

### 5. 会话管理系统 ⚠️ 基础功能遗漏

**数据库表**: `Sessions`

**核心功能**：
- ✅ 用户会话管理（登录状态保持）
- ✅ 会话令牌管理
- ✅ 会话过期管理
- ✅ 多设备登录管理

**业务价值**：
- 登录状态保持
- 安全管理
- 用户体验

**App页面需求**：
- **会话管理页** - 查看当前登录的设备、退出其他设备

**优先级**: P0（v1.0必须实现）

---

### 6. 财务交易系统 ⚠️ 重要功能遗漏

**数据库表**: `FinancialTransactions`

**核心功能**：
- ✅ 财务交易记录（收入、支出）
- ✅ 交易类型管理（deposit, withdraw, transfer等）
- ✅ 交易状态管理（success, pending, failed）
- ✅ 交易ID管理

**业务价值**：
- 财务透明
- 交易追溯
- 合规管理

**App页面需求**：
- **财务交易页** - 查看所有财务交易记录

**优先级**: P1（v1.1实现）

---

### 7. 灵值兑换系统 ⚠️ 重要功能遗漏

**数据库表**: `ContributionValueExchanges`, `WithdrawalRequests`

**核心功能**：
- ✅ 灵值兑换（灵值转现金）
- ✅ 兑换汇率管理
- ✅ 兑换申请管理
- ✅ 兑换记录查询

**业务价值**：
- 灵值变现
- 激励机制
- 用户留存

**App页面需求**：
- **灵值兑换页** - 灵值兑换操作
- **兑换记录页** - 查看兑换记录

**优先级**: P2（v1.2实现）

---

## 三、更新后的完整模块清单（15个）

### 核心业务模块

1. ✅ **用户系统模块** - 用户注册/登录、个人信息管理
2. ✅ **会话管理模块** - 用户会话、登录状态（P0）
3. ✅ **签到系统模块** - 每日签到、签到统计
4. ✅ **情绪系统模块** - 情绪识别、记录、统计、日记（核心）
5. ✅ **智能体系统模块** - 智能对话、情绪识别与回应
6. ✅ **公司动态模块** - 发布和查看公司动态
7. ✅ **财务交易模块** - 财务交易记录（P1）
8. ✅ **灵值兑换模块** - 灵值兑换功能（P2）
9. ✅ **提现管理模块** - 提现申请和审核
10. ✅ **个人中心模块** - 个人信息、灵值余额
11. ✅ **设置模块** - 各类设置

### 社交裂变模块

12. ✅ **推荐关系模块** - 推荐人、推荐奖励（P2）

### 管理功能模块（仅管理员）

13. ✅ **角色权限模块** - 角色管理、权限管理（P3）
14. ✅ **审计日志模块** - 操作日志、安全审计（P3）
15. ✅ **公司信息模块** - 公司信息管理（P3）

---

## 四、更新后的页面清单（22个页面）

### 基础页面（15个）

| 序号 | 页面名称 | 核心功能 | 优先级 |
|------|---------|---------|-------|
| 1 | 启动页 | 显示Logo、自动跳转 | P0 |
| 2 | 登录/注册页 | 用户登录/注册 | P0 |
| 3 | 首页 | 每日签到、公司动态 | P0 |
| 4 | 对话主页 | 智能对话 | P0 |
| 5 | 情绪主页 | 情绪状态、日记、趋势 | P0 |
| 6 | 情绪记录页 | 记录情绪 | P0 |
| 7 | 情绪日记页 | 创建/编辑日记 | P1 |
| 8 | 情绪统计页 | 情绪统计图表 | P1 |
| 9 | 情绪分析页 | 情绪模式分析 | P1 |
| 10 | 个人中心 | 个人信息、灵值余额 | P0 |
| 11 | 个人信息页 | 编辑个人信息 | P1 |
| 12 | 实名认证页 | 实名认证 | P2 |
| 13 | 收款方式页 | 收款方式管理 | P2 |
| 14 | 设置主页 | 各类设置 | P0 |
| 15 | 灵值明细页 | 灵值记录查询 | P1 |

### 新增页面（7个）

| 序号 | 页面名称 | 核心功能 | 优先级 |
|------|---------|---------|-------|
| 16 | 财务交易页 | 查看财务交易记录 | P1 |
| 17 | 灵值兑换页 | 灵值兑换操作 | P2 |
| 18 | 兑换记录页 | 查看兑换记录 | P2 |
| 19 | 推荐页 | 我的推荐人、推荐的人 | P2 |
| 20 | 邀请页 | 生成邀请码、分享邀请 | P2 |
| 21 | 会话管理页 | 查看登录设备、退出设备 | P0 |
| 22 | 公司信息页 | 显示公司基本信息 | P3 |

---

## 五、更新后的功能优先级

### P0 级别（核心功能，v1.0必须实现）- 3个月

1. ✅ 用户注册/登录
2. ✅ 会话管理（新增）
3. ✅ 首页（签到、公司动态）
4. ✅ 对话主页（智能对话）
5. ✅ 情绪主页（情绪状态、日记、趋势）
6. ✅ 情绪记录
7. ✅ 个人中心
8. ✅ 设置主页

### P1 级别（重要功能，v1.1实现）- 3个月

1. ✅ 情绪日记（完整功能）
2. ✅ 情绪统计图表
3. ✅ 情绪模式分析
4. ✅ 个人信息编辑
5. ✅ 灵值明细查询
6. ✅ 签到记录查询
7. ✅ 财务交易页（新增）

### P2 级别（增强功能，v1.2实现）- 2个月

1. ✅ 实名认证
2. ✅ 收款方式管理
3. ✅ 灵值兑换页（新增）
4. ✅ 兑换记录页（新增）
5. ✅ 提现申请
6. ✅ 推荐页（新增）
7. ✅ 邀请页（新增）

### P3 级别（管理功能，v1.3实现）- 2个月

1. ✅ 发布公司动态（管理员）
2. ✅ 提现审核（管理员）
3. ✅ 用户管理（管理员）
4. ✅ 数据统计（管理员）
5. ✅ 角色权限管理（管理员，新增）
6. ✅ 审计日志（管理员，新增）
7. ✅ 公司信息页（新增）

---

## 六、缺失模块的页面设计

### 16. 财务交易页（FinancialTransactions）

**页面布局**：
```
┌─────────────────────────────────────┐
│  ← 财务交易记录                     │
├─────────────────────────────────────┤
│  [收入] [支出] [全部]               │
│                                     │
│  2025年1月                          │
│  ┌───────────────────────────────┐  │
│  │ 💰 +50 灵值                   │  │
│  │ 签到奖励  2025-01-15         │  │
│  └───────────────────────────────┘  │
│  ┌───────────────────────────────┐  │
│  │ 💰 +100 灵值                  │  │
│  │ 推荐奖励  2025-01-14         │  │
│  └───────────────────────────────┘  │
│                                     │
│  2025年1月                          │
│  ┌───────────────────────────────┐  │
│  │ 💸 -50 灵值                   │  │
│  │ 提现成功  2025-01-13         │  │
│  └───────────────────────────────┘  │
│                                     │
└─────────────────────────────────────┘
```

**功能列表**：
- 按类型筛选（收入/支出/全部）
- 按时间分组显示
- 显示交易详情
- 支持导出记录

---

### 17. 灵值兑换页（LingzhiExchange）

**页面布局**：
```
┌─────────────────────────────────────┐
│  ← 灵值兑换                         │
├─────────────────────────────────────┤
│                                     │
│  💰 当前灵值余额                    │
│  ┌───────────────────────────────┐  │
│  │       1,250 灵值               │  │
│  └───────────────────────────────┘  │
│                                     │
│  💱 兑换设置                        │
│  ┌───────────────────────────────┐  │
│  │ 兑换数量: [250] 灵值          │  │
│  │                                 │  │
│  │ 兑换汇率: 1 灵值 = 0.1 元     │  │
│  │                                 │  │
│  │ 预计到账: 25.00 元             │  │
│  └───────────────────────────────┘  │
│                                     │
│  📝 兑换说明                        │
│  • 兑换手续费: 0%                  │
│  • 到账时间: 1-3个工作日           │
│  • 最小兑换: 100 灵值              │
│                                     │
│  [取消]           [立即兑换]         │
│                                     │
└─────────────────────────────────────┘
```

**功能列表**：
- 显示当前灵值余额
- 输入兑换数量
- 显示兑换汇率
- 显示预计到账金额
- 显示兑换说明
- 提交兑换申请

---

### 18. 兑换记录页（ExchangeRecords）

**页面布局**：
```
┌─────────────────────────────────────┐
│  ← 兑换记录                         │
├─────────────────────────────────────┤
│                                     │
│  2025年1月                          │
│  ┌───────────────────────────────┐  │
│  │ 💸 250 灵值 → 25.00 元       │  │
│  │ 状态: ✅ 已到账               │  │
│  │ 2025-01-15                    │  │
│  └───────────────────────────────┘  │
│  ┌───────────────────────────────┐  │
│  │ 💸 100 灵值 → 10.00 元       │  │
│  │ 状态: ⏳ 审核中               │  │
│  │ 2025-01-14                    │  │
│  └───────────────────────────────┘  │
│  ┌───────────────────────────────┐  │
│  │ 💸 500 灵值 → 50.00 元       │  │
│  │ 状态: ❌ 已拒绝               │  │
│  │ 2025-01-10                    │  │
│  └───────────────────────────────┘  │
│                                     │
└─────────────────────────────────────┘
```

**功能列表**：
- 显示兑换记录列表
- 显示兑换状态（审核中/已到账/已拒绝）
- 按时间分组显示
- 点击查看详情

---

### 19. 推荐页（Referral）

**页面布局**：
```
┌─────────────────────────────────────┐
│  ← 我的推荐                         │
├─────────────────────────────────────┤
│                                     │
│  👨‍👩‍👧‍👦 我的推荐关系                   │
│  ┌───────────────────────────────┐  │
│  │ 推荐人: 小明                  │  │
│  │ 邀请码: ABC123                │  │
│  └───────────────────────────────┘  │
│                                     │
│  👥 我推荐的人                      │
│  ┌───────────────────────────────┐  │
│  │ • 小红 (1级)  [已签到5天]     │  │
│  │ • 小李 (1级)  [已签到3天]     │  │
│  │ • 小张 (2级)  [已签到1天]     │  │
│  └───────────────────────────────┘  │
│                                     │
│  💰 推荐奖励                        │
│  ┌───────────────────────────────┐  │
│  │ 累计奖励: 350 灵值            │  │
│  │ 本月奖励: 50 灵值             │  │
│  └───────────────────────────────┘  │
│                                     │
│  [邀请好友 →]                       │
│                                     │
└─────────────────────────────────────┘
```

**功能列表**：
- 显示推荐人信息
- 显示我推荐的人
- 显示推荐奖励
- 跳转到邀请页

---

### 20. 邀请页（Invite）

**页面布局**：
```
┌─────────────────────────────────────┐
│  ← 邀请好友                         │
├─────────────────────────────────────┤
│                                     │
│  🎁 分享邀请，获得奖励！             │
│                                     │
│  🎫 我的邀请码                      │
│  ┌───────────────────────────────┐  │
│  │                               │  │
│  │       ABC123                 │  │
│  │                               │  │
│  │    [复制]                     │  │
│  └───────────────────────────────┘  │
│                                     │
│  🔗 分享链接                        │
│  ┌───────────────────────────────┐  │
│  │ https://lingzhi.app/invite   │  │
│  │    ?code=ABC123              │  │
│  │                               │  │
│  │    [复制]                     │  │
│  └───────────────────────────────┘  │
│                                     │
│  📱 分享到社交媒体                  │
│  ┌───┐ ┌───┐ ┌───┐ ┌───┐          │
│  │📱 │ │💬 │ │📧 │ │💾 │          │
│  │微信│ │QQ │ │邮件│ │复制│         │
│  └───┘ └───┘ └───┘ └───┘          │
│                                     │
│  📋 邀请规则                        │
│  • 每邀请1人获得100灵值            │
│  • 被邀请人签到获得50灵值          │
│  │推荐奖励有效期为30天            │
│                                     │
└─────────────────────────────────────┘
```

**功能列表**：
- 显示邀请码
- 显示分享链接
- 复制邀请码/链接
- 分享到社交媒体
- 显示邀请规则

---

### 21. 会话管理页（SessionManagement）

**页面布局**：
```
┌─────────────────────────────────────┐
│  ← 会话管理                         │
├─────────────────────────────────────┤
│                                     │
│  📱 当前登录设备                    │
│  ┌───────────────────────────────┐  │
│  │ 📱 iPhone 15 Pro              │  │
│  │ 📍 北京市                     │  │
│  │ ⏰ 2025-01-15 10:30           │  │
│  │ ✅ 当前设备                   │  │
│  └───────────────────────────────┘  │
│                                     │
│  📱 其他登录设备                    │
│  ┌───────────────────────────────┐  │
│  │ 💻 Windows PC                 │  │
│  │ 📍 上海市                     │  │
│  │ ⏰ 2025-01-14 15:20           │  │
│  │ [退出]                        │  │
│  └───────────────────────────────┘  │
│                                     │
│  [退出所有其他设备]                  │
│                                     │
└─────────────────────────────────────┘
```

**功能列表**：
- 显示当前登录设备
- 显示其他登录设备
- 退出指定设备
- 退出所有其他设备

---

### 22. 公司信息页（CompanyInfo）

**页面布局**：
```
┌─────────────────────────────────────┐
│  ← 关于我们                         │
├─────────────────────────────────────┤
│                                     │
│  🏢 公司信息                        │
│  ┌───────────────────────────────┐  │
│  │ 公司名称:                      │  │
│  │ 陕西媄月商业艺术有限责任公司    │  │
│  │                                 │  │
│  │ 税号:                          │  │
│  │ XXXXXXXXXXXXXX                │  │
│  │                                 │  │
│  │ 地址:                          │  │
│  │ 陕西省西安市XXX区XXX路XXX号    │  │
│  │                                 │  │
│  │ 电话:                          │  │
│  │ XXX-XXXX-XXXX                 │  │
│  │                                 │  │
│  │ 银行信息:                      │  │
│  │ 银行: 中国工商银行             │  │
│  │ 账号: XXXXXXXXXXXXXX          │  │
│  └───────────────────────────────┘  │
│                                     │
│  📱 联系我们                        │
│  客服电话: XXX-XXXX-XXXX           │
│  客服邮箱: support@lingzhi.app      │
│  官方网站: www.lingzhi.app          │
│                                     │
└─────────────────────────────────────┘
```

**功能列表**：
- 显示公司基本信息
- 显示公司联系方式
- 显示银行信息

---

## 七、总结

### 原规划（15个页面）：
- 基础页面：15个
- 功能模块：8个

### 更新后（22个页面）：
- 基础页面：15个
- 新增页面：7个
- 功能模块：15个

### 遗漏的7个页面：
1. 财务交易页（P1）
2. 灵值兑换页（P2）
3. 兑换记录页（P2）
4. 推荐页（P2）
5. 邀请页（P2）
6. 会话管理页（P0）
7. 公司信息页（P3）

---

**更新日期**: 2025年1月15日
**更新说明**: 补充遗漏的7个重要业务模块和页面
**下一步**: 更新完整版文档
