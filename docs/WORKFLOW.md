# çµå€¼ç”Ÿæ€å›­ç³»ç»Ÿå·¥ä½œæµæ–‡æ¡£ v12.1

## ğŸ“‹ ç›®å½•
- [1. ç³»ç»Ÿæ¦‚è¿°](#1-ç³»ç»Ÿæ¦‚è¿°)
- [2. ç”¨æˆ·æ³¨å†Œä¸ç™»å½•å·¥ä½œæµ](#2-ç”¨æˆ·æ³¨å†Œä¸ç™»å½•å·¥ä½œæµ)
- [3. æ¨èç³»ç»Ÿå·¥ä½œæµ](#3-æ¨èç³»ç»Ÿå·¥ä½œæµ)
- [4. ç”¨æˆ·èµ„æ–™ç®¡ç†å·¥ä½œæµ](#4-ç”¨æˆ·èµ„æ–™ç®¡ç†å·¥ä½œæµ)
- [5. ç³»ç»Ÿæ¶æ„](#5-ç³»ç»Ÿæ¶æ„)
- [6. æ•°æ®æµè½¬](#6-æ•°æ®æµè½¬)

---

## 1. ç³»ç»Ÿæ¦‚è¿°

### 1.1 ç³»ç»Ÿå®šä½
çµå€¼ç”Ÿæ€å›­æ˜¯ä¸€ä¸ªåŸºäº Web ç”Ÿæ€å¹³å°ï¼Œæ”¯æŒç”¨æˆ·æ³¨å†Œã€æ¨èç³»ç»Ÿã€èµ„äº§ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

### 1.2 æ ¸å¿ƒåŠŸèƒ½
- âœ… ç”¨æˆ·æ³¨å†Œä¸ç™»å½•ï¼ˆæ”¯æŒå¾®ä¿¡æˆæƒï¼‰
- âœ… æ¨èç ç³»ç»Ÿï¼ˆäºŒç»´ç åˆ†äº«ï¼‰
- âœ… ç”¨æˆ·èµ„æ–™ç®¡ç†
- âœ… æ¨èå…³ç³»é”å®š

---

## 2. ç”¨æˆ·æ³¨å†Œä¸ç™»å½•å·¥ä½œæµ

### 2.1 æ³¨å†Œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·æ³¨å†Œæµç¨‹                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¼€å§‹
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿›å…¥æ³¨å†Œé¡µé¢          â”‚
â”‚  /register             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ£€æµ‹å¾®ä¿¡ç¯å¢ƒ          â”‚
â”‚  â”œâ”€ æ˜¯ï¼šæ˜¾ç¤ºå¾®ä¿¡æˆæƒ   â”‚
â”‚  â””â”€ å¦ï¼šæ˜¾ç¤ºå¸¸è§„æ³¨å†Œ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·é€‰æ‹©æ³¨å†Œæ–¹å¼      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ–¹å¼1: å¾®ä¿¡æˆæƒ       â”‚
â”‚    â”œâ”€ ç‚¹å‡»å¾®ä¿¡ç™»å½•     â”‚
â”‚    â”œâ”€ å¾®ä¿¡æˆæƒ         â”‚
â”‚    â”œâ”€ è·å–ç”¨æˆ·ä¿¡æ¯     â”‚
â”‚    â”‚  â”œâ”€ æ˜µç§°          â”‚
â”‚    â”‚  â”œâ”€ å¤´åƒ          â”‚
â”‚    â”‚  â””â”€ OpenID        â”‚
â”‚    â””â”€ è‡ªåŠ¨å¡«å……è¡¨å•     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ–¹å¼2: å¸¸è§„æ³¨å†Œ       â”‚
â”‚    â”œâ”€ å¡«å†™ç”¨æˆ·å       â”‚
â”‚    â”œâ”€ å¡«å†™æ‰‹æœºå·       â”‚
â”‚    â”œâ”€ å¡«å†™æ¨èç        â”‚
â”‚    â”œâ”€ å¡«å†™èº«ä»½è¯å·     â”‚
â”‚    â”œâ”€ å¡«å†™é“¶è¡Œå¡å·     â”‚
â”‚    â”œâ”€ å¡«å†™å¼€æˆ·é“¶è¡Œ     â”‚
â”‚    â””â”€ è®¾ç½®å¯†ç          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  éªŒè¯æ¨èç             â”‚
â”‚  â”œâ”€ æ£€æŸ¥å°è¯•æ¬¡æ•°       â”‚
â”‚  â”œâ”€ éªŒè¯æ¨èç æœ‰æ•ˆæ€§   â”‚
â”‚  â””â”€ 3æ¬¡ç©ºå¡«è‡ªåŠ¨è®¸é”‹   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æäº¤æ³¨å†Œè¯·æ±‚          â”‚
â”‚  POST /api/register     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åç«¯å¤„ç†              â”‚
â”‚  â”œâ”€ éªŒè¯å”¯ä¸€æ€§         â”‚
â”‚  â”œâ”€ åˆ›å»ºç”¨æˆ·è®°å½•       â”‚
â”‚  â”œâ”€ ç”Ÿæˆæ¨èç          â”‚
â”‚  â”œâ”€ åˆ›å»ºç”¨æˆ·æ¡£æ¡ˆ       â”‚
â”‚  â””â”€ é”å®šæ¨èå…³ç³»       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ³¨å†ŒæˆåŠŸ              â”‚
â”‚  â”œâ”€ ç”ŸæˆToken          â”‚
â”‚  â”œâ”€ ä¿å­˜ä¼šè¯           â”‚
â”‚  â””â”€ è·³è½¬ä¸»é¡µ           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
ç»“æŸ
```

### 2.2 ç™»å½•æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·ç™»å½•æµç¨‹                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¼€å§‹
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿›å…¥ç™»å½•é¡µé¢          â”‚
â”‚  /login                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ£€æµ‹URLå‚æ•°           â”‚
â”‚  â”œâ”€ æœ‰referral_code    â”‚
â”‚  â””â”€ ä¿å­˜åˆ°ä¸´æ—¶å­˜å‚¨     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·é€‰æ‹©ç™»å½•æ–¹å¼      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ–¹å¼1: å¾®ä¿¡ç™»å½•       â”‚
â”‚    â”œâ”€ ç‚¹å‡»å¾®ä¿¡ç™»å½•     â”‚
â”‚    â”œâ”€ å¾®ä¿¡æˆæƒ         â”‚
â”‚    â”œâ”€ è·å–OpenID       â”‚
â”‚    â””â”€ è‡ªåŠ¨ç™»å½•         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ–¹å¼2: è´¦å·å¯†ç ç™»å½•   â”‚
â”‚    â”œâ”€ è¾“å…¥ç”¨æˆ·å       â”‚
â”‚    â”œâ”€ è¾“å…¥å¯†ç          â”‚
â”‚    â””â”€ æäº¤ç™»å½•         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åç«¯éªŒè¯              â”‚
â”‚  POST /api/login       â”‚
â”‚  â”œâ”€ éªŒè¯ç”¨æˆ·åå¯†ç      â”‚
â”‚  â”œâ”€ ç”ŸæˆToken          â”‚
â”‚  â””â”€ è¿”å›ç”¨æˆ·ä¿¡æ¯       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç™»å½•æˆåŠŸ              â”‚
â”‚  â”œâ”€ ä¿å­˜Token          â”‚
â”‚  â”œâ”€ æ›´æ–°æœ€åç™»å½•æ—¶é—´   â”‚
â”‚  â””â”€ è·³è½¬ä¸»é¡µ           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
ç»“æŸ
```

---

## 3. æ¨èç³»ç»Ÿå·¥ä½œæµ

### 3.1 æ¨èç ç”Ÿæˆæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ¨èç ç”Ÿæˆæµç¨‹                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¼€å§‹
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·æ³¨å†ŒæˆåŠŸ          â”‚
â”‚  ç”¨æˆ·ID: {user_id}     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”Ÿæˆæ¨èç             â”‚
â”‚  ç®—æ³•: ç”¨æˆ·åå‰3ä½    â”‚
â”‚       + 5ä½éšæœºæ•°å­—   â”‚
â”‚  ç¤ºä¾‹: "TES12345"     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¡®ä¿æ¨èç å”¯ä¸€æ€§      â”‚
â”‚  æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å­˜åœ¨   â”‚
â”‚  è‹¥å­˜åœ¨åˆ™é‡æ–°ç”Ÿæˆ     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¿å­˜åˆ°æ•°æ®åº“          â”‚
â”‚  users.referral_code   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”ŸæˆäºŒç»´ç             â”‚
â”‚  URLæ ¼å¼:              â”‚
â”‚  https://meiyueart.com â”‚
â”‚  /register?code=xxx    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¿å­˜äºŒç»´ç å›¾ç‰‡        â”‚
â”‚  å­˜å‚¨è·¯å¾„:             â”‚
â”‚  /assets/qrcodes/      â”‚
â”‚  {user_id}.png        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
ç»“æŸ
```

### 3.2 æ‰«ç æ¨èæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ‰«ç æ¨èæµç¨‹                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¼€å§‹
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·Aåˆ†äº«æ¨èç       â”‚
â”‚  æŸ¥çœ‹ä¸ªäººèµ„æ–™é¡µé¢     â”‚
â”‚  /profile             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ˜¾ç¤ºæ¨èç äºŒç»´ç       â”‚
â”‚  ä¸‹è½½æŒ‰é’®             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·Bæ‰«ç             â”‚
â”‚  æ‰«æäºŒç»´ç            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è·³è½¬åˆ°æ³¨å†Œé¡µé¢       â”‚
â”‚  /register?code=xxx    â”‚
â”‚  å‚æ•°: referral_code   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è‡ªåŠ¨å¡«å……æ¨èç         â”‚
â”‚  å‰ç«¯è¯»å–URLå‚æ•°     â”‚
â”‚  å¡«å……åˆ°æ¨èç è¾“å…¥æ¡†  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·Bå®Œæˆæ³¨å†Œ        â”‚
â”‚  æäº¤æ³¨å†Œè¯·æ±‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åç«¯é”å®šæ¨èå…³ç³»      â”‚
â”‚  â”œâ”€ éªŒè¯æ¨èç          â”‚
â”‚  â”œâ”€ è·å–æ¨èäººID       â”‚
â”‚  â”œâ”€ æ–°ç”¨æˆ·.referrer_id â”‚
â”‚  â”œâ”€ åˆ›å»ºæ¨èå…³ç³»è®°å½•   â”‚
â”‚  â””â”€ è®°å½•æ—¶é—´æˆ³         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¨èå…³ç³»å»ºç«‹å®Œæˆ      â”‚
â”‚  ç”¨æˆ·Aè·å¾—æ¨èå¥–åŠ±     â”‚
â”‚  æ•°æ®æŒä¹…åŒ–           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
ç»“æŸ
```

### 3.3 æ¨èäººå°è¯•æ¬¡æ•°æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ¨èäººå°è¯•æ¬¡æ•°æµç¨‹                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¼€å§‹
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·æ³¨å†Œ             â”‚
â”‚  æœªå¡«å†™æ¨èç          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ£€æŸ¥IPå°è¯•æ¬¡æ•°        â”‚
â”‚  æŸ¥è¯¢:                 â”‚
â”‚  registration_attempts â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é¦–æ¬¡å°è¯•              â”‚
â”‚  â”œâ”€ è®°å½•IPåœ°å€         â”‚
â”‚  â”œâ”€ å°è¯•æ¬¡æ•° = 1       â”‚
â”‚  â””â”€ è¿”å›é”™è¯¯           â”‚
â”‚    "è¿˜å‰©2æ¬¡æœºä¼š"      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬äºŒæ¬¡å°è¯•            â”‚
â”‚  â”œâ”€ å¢åŠ å°è¯•æ¬¡æ•°       â”‚
â”‚  â”œâ”€ å°è¯•æ¬¡æ•° = 2       â”‚
â”‚  â””â”€ è¿”å›é”™è¯¯           â”‚
â”‚    "è¿˜å‰©1æ¬¡æœºä¼š"      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ä¸‰æ¬¡å°è¯•            â”‚
â”‚  â”œâ”€ å°è¯•æ¬¡æ•° = 3       â”‚
â”‚  â”œâ”€ è‡ªåŠ¨è®¾ä¸ºè®¸é”‹      â”‚
â”‚  â”œâ”€ referrer_id = 1    â”‚
â”‚  â””â”€ æ³¨å†ŒæˆåŠŸ           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
ç»“æŸ
```

---

## 4. ç”¨æˆ·èµ„æ–™ç®¡ç†å·¥ä½œæµ

### 4.1 èµ„æ–™æŸ¥çœ‹æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  èµ„æ–™æŸ¥çœ‹æµç¨‹                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¼€å§‹
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿›å…¥ä¸ªäººèµ„æ–™é¡µé¢      â”‚
â”‚  GET /user/profile     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  éªŒè¯Token             â”‚
â”‚  Bearer {token}        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è·å–ç”¨æˆ·ä¿¡æ¯          â”‚
â”‚  â”œâ”€ åŸºæœ¬ä¿¡æ¯           â”‚
â”‚  â”œâ”€ æ¨èç              â”‚
â”‚  â”œâ”€ æ¨èå…³ç³»           â”‚
â”‚  â””â”€ èµ„äº§ä¿¡æ¯           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”Ÿæˆæ¨èç äºŒç»´ç       â”‚
â”‚  GET /api/qrcode       â”‚
â”‚  ?user_id={id}         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ˜¾ç¤ºé¡µé¢              â”‚
â”‚  â”œâ”€ ç”¨æˆ·å¤´åƒ           â”‚
â”‚  â”œâ”€ åŸºæœ¬ä¿¡æ¯           â”‚
â”‚  â”œâ”€ æ¨èç              â”‚
â”‚  â”œâ”€ æ¨èç äºŒç»´ç        â”‚
â”‚  â””â”€ ä¸‹è½½æŒ‰é’®           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
ç»“æŸ
```

### 4.2 èµ„æ–™ç¼–è¾‘æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  èµ„æ–™ç¼–è¾‘æµç¨‹                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¼€å§‹
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç‚¹å‡»ç¼–è¾‘æŒ‰é’®          â”‚
â”‚  è¿›å…¥ç¼–è¾‘æ¨¡å¼         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·å¡«å†™ä¿¡æ¯          â”‚
â”‚  â”œâ”€ ç”¨æˆ·å*            â”‚
â”‚  â”œâ”€ é‚®ç®±               â”‚
â”‚  â”œâ”€ æ‰‹æœºå·             â”‚
â”‚  â”œâ”€ çœŸå®å§“å           â”‚
â”‚  â”œâ”€ æ€§åˆ«ï¼ˆç”·/å¥³ï¼‰      â”‚
â”‚  â”œâ”€ å¤´åƒURL            â”‚
â”‚  â”œâ”€ å¤´è¡”               â”‚
â”‚  â”œâ”€ èŒä½               â”‚
â”‚  â”œâ”€ ä¸ªäººç®€ä»‹           â”‚
â”‚  â”œâ”€ æ‰€åœ¨åœ°             â”‚
â”‚  â””â”€ ä¸ªäººç½‘ç«™           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æäº¤æ›´æ–°è¯·æ±‚          â”‚
â”‚  PUT /user/profile     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åç«¯éªŒè¯              â”‚
â”‚  â”œâ”€ æ€§åˆ«éªŒè¯           â”‚
â”‚  â”‚  åªå…è®¸"ç”·"æˆ–"å¥³"  â”‚
â”‚  â”œâ”€ å”¯ä¸€æ€§éªŒè¯         â”‚
â”‚  â””â”€ æ¨èç ä¿æŠ¤         â”‚
â”‚    ä¸å¯ä¿®æ”¹           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ›´æ–°æ•°æ®åº“            â”‚
â”‚  UPDATE users SET ...  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿”å›æ›´æ–°åæ•°æ®        â”‚
â”‚  åˆ·æ–°é¡µé¢æ˜¾ç¤º         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
ç»“æŸ
```

### 4.3 æ¨èç äºŒç»´ç ä¸‹è½½æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ¨èç äºŒç»´ç ä¸‹è½½æµç¨‹                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¼€å§‹
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·æŸ¥çœ‹ä¸ªäººèµ„æ–™      â”‚
â”‚  /profile             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ˜¾ç¤ºæ¨èç äºŒç»´ç       â”‚
â”‚  ç”Ÿæˆå¹¶å±•ç¤ºå›¾ç‰‡       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·ç‚¹å‡»ä¸‹è½½æŒ‰é’®      â”‚
â”‚  è§¦å‘ä¸‹è½½äº‹ä»¶         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åç«¯ç”ŸæˆäºŒç»´ç         â”‚
â”‚  GET /api/qrcode       â”‚
â”‚  ?download=true       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿”å›å›¾ç‰‡æ–‡ä»¶          â”‚
â”‚  Content-Type: image/pngâ”‚
â”‚  Content-Disposition:   â”‚
â”‚  attachment; filename= â”‚
â”‚  referral_qrcode.png   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æµè§ˆå™¨è§¦å‘ä¸‹è½½        â”‚
â”‚  ä¿å­˜åˆ°æœ¬åœ°           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
ç»“æŸ
```

---

## 5. ç³»ç»Ÿæ¶æ„

### 5.1 æŠ€æœ¯æ ˆ

#### å‰ç«¯
- **æ¡†æ¶**: React 18.3.1
- **è¯­è¨€**: TypeScript 5.4.5
- **æ„å»ºå·¥å…·**: Vite 5.4.21
- **UIç»„ä»¶**: è‡ªå®šä¹‰ + Lucide Icons
- **çŠ¶æ€ç®¡ç†**: React Context (AuthContext)
- **HTTPå®¢æˆ·ç«¯**: Axios

#### åç«¯
- **æ¡†æ¶**: Flask
- **æ•°æ®åº“**: SQLite
- **è®¤è¯**: JWT + bcrypt
- **APIæ¶æ„**: RESTful
- **éƒ¨ç½²**: Gunicorn + Nginx

### 5.2 ç›®å½•ç»“æ„

```
workspace/projects/
â”œâ”€â”€ admin-backend/          # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ app.py             # ä¸»åº”ç”¨
â”‚   â”œâ”€â”€ database_init.py   # æ•°æ®åº“åˆå§‹åŒ–
â”‚   â”œâ”€â”€ routes/            # APIè·¯ç”±
â”‚   â”œâ”€â”€ lingzhi_ecosystem.db # SQLiteæ•°æ®åº“
â”‚   â””â”€â”€ assets/qrcodes/    # æ¨èç äºŒç»´ç å­˜å‚¨
â”œâ”€â”€ web-app/               # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/         # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Register.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Login.tsx
â”‚   â”‚   â”‚   â””â”€â”€ Profile.tsx
â”‚   â”‚   â”œâ”€â”€ contexts/      # Context
â”‚   â”‚   â”‚   â””â”€â”€ AuthContext.tsx
â”‚   â”‚   â””â”€â”€ services/      # APIæœåŠ¡
â”‚   â”‚       â””â”€â”€ api.ts
â”‚   â””â”€â”€ dist/             # æ„å»ºäº§ç‰©
â”œâ”€â”€ docs/                  # æ–‡æ¡£
â”‚   â””â”€â”€ WORKFLOW.md       # å·¥ä½œæµæ–‡æ¡£
â””â”€â”€ scripts/              # è„šæœ¬
    â””â”€â”€ deploy-std.sh    # éƒ¨ç½²è„šæœ¬
```

### 5.3 æ•°æ®åº“è¡¨ç»“æ„

#### users è¡¨
```sql
CREATE TABLE users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT UNIQUE NOT NULL,
    email TEXT,
    phone TEXT UNIQUE NOT NULL,
    password_hash TEXT NOT NULL,
    referral_code TEXT UNIQUE,           -- æ¨èç 
    referrer_id INTEGER,                 -- æ¨èäººID
    avatar_url TEXT,                     -- å¤´åƒURL
    real_name TEXT,                      -- çœŸå®å§“å
    gender TEXT,                         -- æ€§åˆ«ï¼ˆç”·/å¥³ï¼‰
    title TEXT,                          -- å¤´è¡”
    position TEXT,                       -- èŒä½
    bio TEXT,                           -- ä¸ªäººç®€ä»‹
    location TEXT,                       -- æ‰€åœ¨åœ°
    website TEXT,                        -- ä¸ªäººç½‘ç«™
    total_lingzhi INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    wechat_openid TEXT UNIQUE,           -- å¾®ä¿¡OpenID
    wechat_unionid TEXT,                 -- å¾®ä¿¡UnionID
    wechat_nickname TEXT,                -- å¾®ä¿¡æ˜µç§°
    wechat_avatar TEXT,                  -- å¾®ä¿¡å¤´åƒ
    wechat_bound BOOLEAN DEFAULT 0,      -- æ˜¯å¦ç»‘å®šå¾®ä¿¡
    FOREIGN KEY (referrer_id) REFERENCES users(id)
);
```

#### user_profiles è¡¨
```sql
CREATE TABLE user_profiles (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER UNIQUE NOT NULL,
    id_card TEXT,                        -- èº«ä»½è¯å·
    bank_account TEXT,                   -- é“¶è¡Œå¡å·
    bank_name TEXT,                      -- å¼€æˆ·é“¶è¡Œ
    is_completed BOOLEAN DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

#### registration_attempts è¡¨
```sql
CREATE TABLE registration_attempts (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    ip_address TEXT NOT NULL UNIQUE,
    attempt_count INTEGER DEFAULT 1,
    last_attempt_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### referral_relationships è¡¨
```sql
CREATE TABLE referral_relationships (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    referrer_id INTEGER NOT NULL,
    referee_id INTEGER NOT NULL UNIQUE,
    level INTEGER DEFAULT 1,
    status TEXT DEFAULT 'active',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (referrer_id) REFERENCES users(id),
    FOREIGN KEY (referee_id) REFERENCES users(id)
);
```

---

## 6. æ•°æ®æµè½¬

### 6.1 æ³¨å†Œæ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥
  â†“
å‰ç«¯éªŒè¯
  â”œâ”€ ç”¨æˆ·å: éç©º
  â”œâ”€ æ‰‹æœºå·: éç©º, æ ¼å¼æ­£ç¡®
  â”œâ”€ æ¨èç : éªŒè¯æˆ–3æ¬¡ç©ºå¡«
  â”œâ”€ èº«ä»½è¯å·: éç©º, 18ä½
  â”œâ”€ é“¶è¡Œå¡å·: éç©º
  â”œâ”€ å¼€æˆ·é“¶è¡Œ: éç©º
  â””â”€ å¯†ç : éç©º, æœ€å°‘6ä½
  â†“
APIè¯·æ±‚
  POST /api/register
  Body: { username, phone, referral_code, ... }
  â†“
åç«¯éªŒè¯
  â”œâ”€ æ£€æŸ¥ç”¨æˆ·åå”¯ä¸€æ€§
  â”œâ”€ æ£€æŸ¥æ‰‹æœºå·å”¯ä¸€æ€§
  â”œâ”€ éªŒè¯æ¨èç æœ‰æ•ˆæ€§
  â””â”€ æ£€æŸ¥IPå°è¯•æ¬¡æ•°
  â†“
æ•°æ®åº“æ“ä½œ
  â”œâ”€ INSERT INTO users
  â”œâ”€ INSERT INTO user_profiles
  â”œâ”€ INSERT INTO referral_relationships
  â””â”€ UPDATE registration_attempts
  â†“
å“åº”
  { success: true, data: { token, user } }
  â†“
å‰ç«¯å¤„ç†
  â”œâ”€ ä¿å­˜Tokenåˆ°localStorage
  â”œâ”€ æ›´æ–°AuthContext
  â””â”€ è·³è½¬åˆ°ä¸»é¡µ
```

### 6.2 æ¨èå…³ç³»æ•°æ®æµ

```
ç”¨æˆ·Aåˆ†äº«
  â†“
ç”Ÿæˆæ¨èç äºŒç»´ç 
  â”œâ”€ è¯»å–A.referral_code
  â”œâ”€ ç”ŸæˆäºŒç»´ç å›¾ç‰‡
  â”œâ”€ URL: /register?code={referral_code}
  â””â”€ ä¿å­˜åˆ° assets/qrcodes/{user_id}.png
  â†“
ç”¨æˆ·Bæ‰«ç 
  â†“
è·³è½¬åˆ°æ³¨å†Œé¡µé¢
  /register?code=TES12345
  â†“
å‰ç«¯è‡ªåŠ¨å¡«å……
  â””â”€ referral_code = TES12345
  â†“
ç”¨æˆ·Bæ³¨å†Œ
  â†“
åç«¯é”å®šå…³ç³»
  â”œâ”€ éªŒè¯æ¨èç  TES12345
  â”œâ”€ æŸ¥è¯¢ referrer_id (ç”¨æˆ·Açš„ID)
  â”œâ”€ è®¾ç½® B.referrer_id = A.id
  â”œâ”€ INSERT referral_relationships
  â”‚   (referrer_id=A.id, referee_id=B.id)
  â””â”€ å…³ç³»æŒä¹…åŒ–
  â†“
æ¨èå…³ç³»å»ºç«‹å®Œæˆ
```

### 6.3 ç”¨æˆ·èµ„æ–™æ›´æ–°æ•°æ®æµ

```
ç”¨æˆ·ç¼–è¾‘èµ„æ–™
  â†“
å‰ç«¯æäº¤
  PUT /user/profile
  Body: { username, gender, ... }
  â†“
åç«¯éªŒè¯
  â”œâ”€ éªŒè¯æ€§åˆ«ï¼ˆç”·/å¥³ï¼‰
  â”œâ”€ æ£€æŸ¥ç”¨æˆ·åå”¯ä¸€æ€§
  â”œâ”€ æ£€æŸ¥é‚®ç®±å”¯ä¸€æ€§
  â”œâ”€ æ£€æŸ¥æ‰‹æœºå·å”¯ä¸€æ€§
  â””â”€ ä¿æŠ¤æ¨èç ï¼ˆä¸å…è®¸ä¿®æ”¹ï¼‰
  â†“
æ•°æ®åº“æ›´æ–°
  UPDATE users
  SET
    username = ?,
    gender = ?,
    bio = ?,
    location = ?,
    website = ?,
    updated_at = CURRENT_TIMESTAMP
  WHERE id = ?
  â†“
å“åº”
  { success: true, data: { user } }
  â†“
å‰ç«¯åˆ·æ–°
  â”œâ”€ æ›´æ–°ç”¨æˆ·ä¿¡æ¯
  â””â”€ æ˜¾ç¤ºæœ€æ–°æ•°æ®
```

---

## 7. APIæ¥å£æ¸…å•

### 7.1 æ³¨å†Œç›¸å…³

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | /api/register | ç”¨æˆ·æ³¨å†Œ |
| POST | /api/login | ç”¨æˆ·ç™»å½• |
| POST | /api/wechat/login | å¾®ä¿¡ç™»å½• |
| GET | /api/wechat/auth | å¾®ä¿¡æˆæƒå›è°ƒ |

### 7.2 ç”¨æˆ·èµ„æ–™ç›¸å…³

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | /api/user/profile | è·å–ç”¨æˆ·ä¿¡æ¯ |
| PUT | /api/user/profile | æ›´æ–°ç”¨æˆ·ä¿¡æ¯ |
| GET | /api/user/info | è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ |
| POST | /api/user/profile | å®Œå–„ç”¨æˆ·ä¿¡æ¯ |

### 7.3 æ¨èç ç›¸å…³

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | /api/qrcode | ç”Ÿæˆ/è·å–æ¨èç äºŒç»´ç  |
| GET | /api/referral/validate | éªŒè¯æ¨èç  |
| GET | /api/referral/stats | è·å–æ¨èç»Ÿè®¡ |

### 7.4 å¾®ä¿¡ç›¸å…³

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | /api/wechat/config | è·å–å¾®ä¿¡é…ç½® |
| GET | /api/wechat/auth-url | è·å–å¾®ä¿¡æˆæƒURL |
| GET | /api/wechat/userinfo | è·å–å¾®ä¿¡ç”¨æˆ·ä¿¡æ¯ |

---

## 8. å‰ç«¯è·¯ç”±é…ç½®

| è·¯å¾„ | ç»„ä»¶ | è¯´æ˜ |
|------|------|------|
| / | Home | é¦–é¡µ |
| /login | Login | ç™»å½•é¡µ |
| /register | Register | æ³¨å†Œé¡µï¼ˆæ”¯æŒ?codeå‚æ•°ï¼‰ |
| /profile | Profile | ä¸ªäººèµ„æ–™ |
| /profile/edit | ProfileEdit | ç¼–è¾‘èµ„æ–™ |

---

## 9. çŠ¶æ€ç®¡ç†

### 9.1 AuthContext

```typescript
interface AuthContextType {
  user: User | null
  loading: boolean
  authError: string | null
  login: (username, password) => Promise<boolean>
  register: (...) => Promise<boolean>
  logout: () => void
  updateUser: (user: User) => void
}
```

### 9.2 Useræ•°æ®ç»“æ„

```typescript
interface User {
  id: number
  username: string
  email: string
  phone: string
  referral_code: string
  referrer_id?: number
  avatar_url?: string
  real_name?: string
  gender?: string  // "ç”·" | "å¥³"
  bio?: string
  location?: string
  website?: string
  created_at: string
  updated_at: string
  // å¾®ä¿¡ç›¸å…³
  wechat_openid?: string
  wechat_nickname?: string
  wechat_avatar?: string
}
```

---

## 10. å®‰å…¨æœºåˆ¶

### 10.1 è®¤è¯ä¸æˆæƒ

- âœ… JWT Tokenè®¤è¯
- âœ… Tokenè¿‡æœŸæ—¶é—´: 24å°æ—¶
- âœ… å¯†ç bcryptåŠ å¯†
- âœ… APIè¯·æ±‚é‰´æƒ

### 10.2 æ•°æ®éªŒè¯

- âœ… å‰ç«¯è¡¨å•éªŒè¯
- âœ… åç«¯æ•°æ®éªŒè¯
- âœ… SQLæ³¨å…¥é˜²æŠ¤
- âœ… XSSé˜²æŠ¤

### 10.3 æ¨èç³»ç»Ÿå®‰å…¨

- âœ… æ¨èç å”¯ä¸€æ€§
- âœ… æ¨èå…³ç³»ä¸å¯ç¯¡æ”¹
- âœ… IPåœ°å€å°è¯•é™åˆ¶
- âœ… æ¨èäºº3æ¬¡è‡ªåŠ¨æœºåˆ¶

---

## 11. éƒ¨ç½²æ¶æ„

```
ç”¨æˆ·æµè§ˆå™¨
    â†“
Nginx (443/80)
    â†“
Gunicorn (8080)
    â†“
Flask App
    â†“
SQLite Database
```

---

## 12. åç»­ä¼˜åŒ–æ–¹å‘

### 12.1 å¾®ä¿¡é›†æˆ
- [ ] å¾®ä¿¡æˆæƒç™»å½•
- [ ] å¾®ä¿¡ä¿¡æ¯è‡ªåŠ¨å¡«å……
- [ ] å¾®ä¿¡è´¦å·ç»‘å®š

### 12.2 æ¨èç³»ç»Ÿ
- [x] æ¨èç ç”Ÿæˆ
- [x] æ¨èç äºŒç»´ç 
- [x] æ¨èå…³ç³»é”å®š
- [ ] æ¨èç»Ÿè®¡æŠ¥è¡¨
- [ ] æ¨èå¥–åŠ±æœºåˆ¶

### 12.3 ç”¨æˆ·ä½“éªŒ
- [ ] äºŒç»´ç æ ·å¼è‡ªå®šä¹‰
- [ ] æ¨èç åˆ†äº«åŠŸèƒ½
- [ ] æ¨èäººåˆ—è¡¨å±•ç¤º
- [ ] æ¨èæ”¶ç›Šå±•ç¤º

### 12.4 æ•°æ®åˆ†æ
- [ ] ç”¨æˆ·æ³¨å†Œç»Ÿè®¡
- [ ] æ¨èå…³ç³»åˆ†æ
- [ ] ç”¨æˆ·è¡Œä¸ºåˆ†æ
- [ ] æ•°æ®å¯è§†åŒ–

---

**æ–‡æ¡£ç‰ˆæœ¬**: v12.1
**æœ€åæ›´æ–°**: 2026-02-13
**ç»´æŠ¤è€…**: Coze Coding
