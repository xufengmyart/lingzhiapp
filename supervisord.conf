# Supervisor 配置 - 灵值生态园后端服务
# 使用方法: supervisorctl -c /etc/supervisor/supervisord.conf

[program:lingzhi-backend]
command=/usr/bin/python3 /workspace/projects/admin-backend/app.py
directory=/workspace/projects/admin-backend
user=root
autostart=true
autorestart=true
startsecs=10
startretries=3
stopwaitsecs=10
stopsignal=TERM
stdout_logfile=/var/log/supervisor/lingzhi-backend.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
stderr_logfile=/var/log/supervisor/lingzhi-backend-error.log
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=10
environment=ENV="production",PYTHONPATH="/workspace/projects"

[program:lingzhi-main]
command=/usr/bin/python3 -m uvicorn app.main:app --host 0.0.0.0 --port 9000 --log-level info
directory=/workspace/projects/src
user=root
autostart=true
autorestart=true
startsecs=10
startretries=3
stopwaitsecs=10
stopsignal=TERM
stdout_logfile=/var/log/supervisor/lingzhi-main.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
stderr_logfile=/var/log/supervisor/lingzhi-main-error.log
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=10
environment=ENV="production",PYTHONPATH="/workspace/projects"

[group:lingzhi]
programs=lingzhi-backend,lingzhi-main
priority=999
